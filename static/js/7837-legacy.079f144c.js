"use strict";(self["webpackChunkvue_url_arcgis"]=self["webpackChunkvue_url_arcgis"]||[]).push([[7837],{27376:function(e,t,r){r.d(t,{Z:function(){return d}});var n=r(92751),a=r(76133),i=r(99418),o=r(49161),s=(r(82526),r(41817),r(63825)),u=r(8723),l=r(71741),c=r(2553),p=(r(57787),r(35425),r(90202),r(92236)),f=new u.Xn({esriJobMessageTypeInformative:"informative",esriJobMessageTypeProcessDefinition:"process-definition",esriJobMessageTypeProcessStart:"process-start",esriJobMessageTypeProcessStop:"process-stop",esriJobMessageTypeWarning:"warning",esriJobMessageTypeError:"error",esriJobMessageTypeEmpty:"empty",esriJobMessageTypeAbort:"abort"}),y=function(e){(0,i.Z)(r,e);var t=(0,o.Z)(r);function r(e){var n;return(0,a.Z)(this,r),n=t.call(this,e),n.description=null,n.type=null,n}return(0,n.Z)(r)}(l.wq);(0,s._)([(0,c.Cb)({type:String,json:{write:!0}})],y.prototype,"description",void 0),(0,s._)([(0,c.Cb)({type:String,json:{read:f.read,write:f.write}})],y.prototype,"type",void 0),y=(0,s._)([(0,p.j)("esri.rest.support.GPMessage")],y);var d=y},67837:function(e,t,r){r.r(t),r.d(t,{default:function(){return $t}});var n=r(16198),a=r(4367),i=r(76133),o=r(92751),s=r(99418),u=r(49161),l=(r(78975),r(92222),r(63825)),c=r(8723),p=r(2553),f=(r(57787),r(35425),r(90202)),y=r(92236),d=r(1936),m=r(62032),b=(r(51532),r(41539),r(78783),r(33948),r(47042),r(83753),r(54747),r(21249),r(68309),r(74916),r(15306),r(27852),r(24603),r(28450),r(88386),r(39714),r(77601),r(26699),r(32023),r(38862),r(57327),r(70189),r(91038),r(43290),r(54560)),h=r(68224),v=r(35680),g=r(25585),x=r(27092),w=r(597),S=r(58476),k=r(72110),P=r(63390),Z=r(72972),D=r(44171),R=r(7230),M=r(7730),I=function(e){(0,s.Z)(r,e);var t=(0,u.Z)(r);function r(){var e;return(0,i.Z)(this,r),e=t.apply(this,arguments),e.outSpatialReference=null,e.processExtent=null,e.processSpatialReference=null,e.returnFeatureCollection=!1,e.returnM=!1,e.returnZ=!1,e}return(0,o.Z)(r)}(D.Z);(0,l._)([(0,p.Cb)({type:M.Z})],I.prototype,"outSpatialReference",void 0),(0,l._)([(0,p.Cb)({type:R.Z})],I.prototype,"processExtent",void 0),(0,l._)([(0,p.Cb)({type:M.Z})],I.prototype,"processSpatialReference",void 0),(0,l._)([(0,p.Cb)({nonNullable:!0})],I.prototype,"returnFeatureCollection",void 0),(0,l._)([(0,p.Cb)({nonNullable:!0})],I.prototype,"returnM",void 0),(0,l._)([(0,p.Cb)({nonNullable:!0})],I.prototype,"returnZ",void 0),I=(0,l._)([(0,y.j)("esri/rest/geoprocessor/GPOptions")],I),I.from=(0,f.se)(I);var G=I,L=r(9726),T=r(61859),O=r(46713),V=r(71741),_=function(e){(0,s.Z)(r,e);var t=(0,u.Z)(r);function r(){var e;return(0,i.Z)(this,r),e=t.apply(this,arguments),e.extent=null,e.height=null,e.href=null,e.opacity=1,e.rotation=0,e.scale=null,e.visible=!0,e.width=null,e}return(0,o.Z)(r)}(V.wq);(0,l._)([(0,p.Cb)({type:R.Z})],_.prototype,"extent",void 0),(0,l._)([(0,p.Cb)()],_.prototype,"height",void 0),(0,l._)([(0,p.Cb)()],_.prototype,"href",void 0),(0,l._)([(0,p.Cb)()],_.prototype,"opacity",void 0),(0,l._)([(0,p.Cb)()],_.prototype,"rotation",void 0),(0,l._)([(0,p.Cb)()],_.prototype,"scale",void 0),(0,l._)([(0,p.Cb)()],_.prototype,"visible",void 0),(0,l._)([(0,p.Cb)()],_.prototype,"width",void 0),_=(0,l._)([(0,y.j)("esri.layer.support.MapImage")],_);var C=_,J=r(19724),j=function(e){(0,s.Z)(r,e);var t=(0,u.Z)(r);function r(e){var n;return(0,i.Z)(this,r),n=t.call(this,e),n.itemId=null,n.url=null,n}return(0,o.Z)(r)}(V.wq);(0,l._)([(0,p.Cb)({type:String,json:{read:{source:"itemID"},write:{target:"itemID"}}})],j.prototype,"itemId",void 0),(0,l._)([(0,p.Cb)({type:String,json:{write:!0}})],j.prototype,"url",void 0),j=(0,l._)([(0,y.j)("esri.rest.support.DataFile")],j);var F=j,N=r(7804),E=new c.Xn({esriMeters:"meters",esriFeet:"feet",esriKilometers:"kilometers",esriMiles:"miles",esriNauticalMiles:"nautical-miles",esriYards:"yards"},{ignoreUnknown:!1}),A=function(e){(0,s.Z)(r,e);var t=(0,u.Z)(r);function r(e){var n;return(0,i.Z)(this,r),n=t.call(this,e),n.distance=0,n.units=null,n}return(0,o.Z)(r)}(V.wq);(0,l._)([(0,p.Cb)({json:{write:!0}})],A.prototype,"distance",void 0),(0,l._)([(0,p.Cb)({json:{read:E.read,write:E.write}})],A.prototype,"units",void 0),A=(0,l._)([(0,y.j)("esri/rest/support/LinearUnit")],A);var U=A,q=new c.Xn({GPBoolean:"boolean",GPDataFile:"data-file",GPDate:"date",GPDouble:"double",GPFeatureRecordSetLayer:"feature-record-set-layer",GPField:"field",GPLinearUnit:"linear-unit",GPLong:"long",GPRasterData:"raster-data",GPRasterDataLayer:"raster-data-layer",GPRecordSet:"record-set",GPString:"string","GPMultiValue:GPBoolean":"multi-value","GPMultiValue:GPDataFile":"multi-value","GPMultiValue:GPDate":"multi-value","GPMultiValue:GPDouble":"multi-value","GPMultiValue:GPFeatureRecordSetLayer":"multi-value","GPMultiValue:GPField":"multi-value","GPMultiValue:GPLinearUnit":"multi-value","GPMultiValue:GPLong":"multi-value","GPMultiValue:GPRasterData":"multi-value","GPMultiValue:GPRasterDataLayer":"multi-value","GPMultiValue:GPRecordSet":"multi-value","GPMultiValue:GPString":"multi-value"}),z=function(e){(0,s.Z)(r,e);var t=(0,u.Z)(r);function r(e){var n;return(0,i.Z)(this,r),n=t.call(this,e),n.dataType=null,n.value=null,n}return(0,o.Z)(r)}(V.wq);(0,l._)([(0,p.Cb)({json:{read:q.read,write:q.write}})],z.prototype,"dataType",void 0),(0,l._)([(0,p.Cb)()],z.prototype,"value",void 0),z=(0,l._)([(0,y.j)("esri.rest.support.ParameterValue")],z);var W=z,B=function(e){(0,s.Z)(r,e);var t=(0,u.Z)(r);function r(e){var n;return(0,i.Z)(this,r),n=t.call(this,e),n.format=null,n.itemId=null,n.url=null,n}return(0,o.Z)(r)}(V.wq);(0,l._)([(0,p.Cb)()],B.prototype,"format",void 0),(0,l._)([(0,p.Cb)({json:{read:{source:"itemID"},write:{target:"itemID"}}})],B.prototype,"itemId",void 0),(0,l._)([(0,p.Cb)()],B.prototype,"url",void 0),B=(0,l._)([(0,y.j)("esri/rest/support/RasterData")],B);var K=B;function X(e,t,r,n,a){return Q.apply(this,arguments)}function Q(){return Q=(0,n.Z)(regeneratorRuntime.mark((function e(t,r,n,i,o){var s,u,l;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return s={},u={},l=[],e.abrupt("return",(Y(i,l,s),(0,T.aX)(l).then((function(e){var l=n.outSpatialReference,c=n.processExtent,p=n.processSpatialReference,f=n.returnFeatureCollection,y=n.returnM,d=n.returnZ,m=(0,J.en)(t),b=m.path;for(var h in s){var g=s[h];u[h]=e.slice(g[0],g[1])}var x=l?l.wkid||l:null,w=p?p.wkid||p:null,S="execute"===r?{returnFeatureCollection:f||void 0,returnM:y||void 0,returnZ:d||void 0}:null,k=$((0,a.Z)((0,a.Z)((0,a.Z)((0,a.Z)({},c?{context:{extent:c,outSR:x,processSR:w}}:{"env:outSR":x,"env:processSR":w}),i),S),{},{f:"json"}),null,u),P=(0,a.Z)((0,a.Z)({},o),{},{query:k});return(0,v["default"])("".concat(b,"/").concat(r),P)}))));case 2:case"end":return e.stop()}}),e)}))),Q.apply(this,arguments)}function Y(e,t,r){for(var n in e){var a=e[n];if(a&&"object"==(0,L.Z)(a)&&a instanceof N["default"]){var i=a.features;r[n]=[t.length,t.length+i.length],i.forEach((function(e){t.push(e.geometry)}))}}}function H(e){var t=e.dataType,r=W.fromJSON(e);switch(t){case"GPBoolean":case"GPDouble":case"GPLong":case"GPString":case"GPMultiValue:GPBoolean":case"GPMultiValue:GPDouble":case"GPMultiValue:GPLong":case"GPMultiValue:GPString":return r;case"GPDate":r.value=new Date(r.value);break;case"GPDataFile":r.value=F.fromJSON(r.value);break;case"GPLinearUnit":r.value=U.fromJSON(r.value);break;case"GPFeatureRecordSetLayer":case"GPRecordSet":var n=e.value.url;r.value=n?F.fromJSON(r.value):N["default"].fromJSON(r.value);break;case"GPRasterData":case"GPRasterDataLayer":var a=e.value.mapImage;r.value=a?C.fromJSON(a):K.fromJSON(r.value);break;case"GPField":r.value=O.Z.fromJSON(r.value);break;case"GPMultiValue:GPDate":var i=r.value;r.value=i.map((function(e){return new Date(e)}));break;case"GPMultiValue:GPDataFile":r.value=r.value.map((function(e){return F.fromJSON(e)}));break;case"GPMultiValue:GPLinearUnit":r.value=r.value.map((function(e){return U.fromJSON(e)}));break;case"GPMultiValue:GPFeatureRecordSetLayer":case"GPMultiValue:GPRecordSet":r.value=r.value.map((function(e){return N["default"].fromJSON(e)}));break;case"GPMultiValue:GPRasterData":case"GPMultiValue:GPRasterDataLayer":r.value=r.value.map((function(e){return e?C.fromJSON(e):K.fromJSON(r.value)}));break;case"GPMultiValue:GPField":r.value=r.value.map((function(e){return O.Z.fromJSON(e)}))}return r}function $(e,t,r){for(var n in e){var a=e[n];Array.isArray(a)?e[n]=JSON.stringify(a.map((function(e){return $({item:e},!0).item}))):a instanceof Date&&(e[n]=a.getTime())}return(0,J.cv)(e,t,r)}var ee=r(27376);function te(e,t,r,n){return re.apply(this,arguments)}function re(){return re=(0,n.Z)(regeneratorRuntime.mark((function e(t,r,n,a){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",(n=G.from(n||{}),X(t,"execute",n,r,a).then((function(e){var t=e.data.results||[],r=e.data.messages||[];return{results:t.map(H),messages:r.map((function(e){return ee.Z.fromJSON(e)}))}}))));case 1:case"end":return e.stop()}}),e)}))),re.apply(this,arguments)}var ne,ae=r(24446),ie=new c.Xn({esriJobCancelled:"job-cancelled",esriJobCancelling:"job-cancelling",esriJobDeleted:"job-deleted",esriJobDeleting:"job-deleting",esriJobTimedOut:"job-timed-out",esriJobExecuting:"job-executing",esriJobFailed:"job-failed",esriJobNew:"job-new",esriJobSubmitted:"job-submitted",esriJobSucceeded:"job-succeeded",esriJobWaiting:"job-waiting"}),oe=ne=function(e){(0,s.Z)(l,e);var t=(0,u.Z)(l);function l(e){var r;return(0,i.Z)(this,l),r=t.call(this,e),r.jobId=null,r.jobStatus=null,r.messages=null,r.requestOptions=null,r.sourceUrl=null,r._timer=null,r}return(0,o.Z)(l,[{key:"cancelJob",value:function(e){var t=this,r=this.jobId,n=this.sourceUrl,i=(0,J.en)(n),o=i.path,s=(0,a.Z)((0,a.Z)((0,a.Z)({},this.requestOptions),e),{},{query:{f:"json"}});return this._clearTimer(),(0,v["default"])("".concat(o,"/jobs/").concat(r,"/cancel"),s).then((function(e){var r=ne.fromJSON(e.data);return t.messages=r.messages,t.jobStatus=r.jobStatus,t}))}},{key:"destroy",value:function(){clearInterval(this._timer)}},{key:"checkJobStatus",value:function(e){var t=this,r=(0,J.en)(this.sourceUrl),n=r.path,i=(0,a.Z)((0,a.Z)((0,a.Z)({},this.requestOptions),e),{},{query:{f:"json"}}),o="".concat(n,"/jobs/").concat(this.jobId);return(0,v["default"])(o,i).then((function(e){var r=e.data,n=ne.fromJSON(r);return t.messages=n.messages,t.jobStatus=n.jobStatus,t}))}},{key:"fetchResultData",value:function(e,t,r){t=G.from(t||{});var n=t,i=n.returnFeatureCollection,o=n.returnM,s=n.returnZ,u=n.outSpatialReference,l=(0,J.en)(this.sourceUrl),c=l.path,p=$({returnFeatureCollection:i,returnM:o,returnZ:s,outSR:u,returnType:"data",f:"json"},null),f=(0,a.Z)((0,a.Z)((0,a.Z)({},this.requestOptions),r),{},{query:p}),y="".concat(c,"/jobs/").concat(this.jobId,"/results/").concat(e);return(0,v["default"])(y,f).then((function(e){return H(e.data)}))}},{key:"fetchResultImage",value:function(e,t,r){var n=(0,J.en)(this.sourceUrl),i=n.path,o=(0,a.Z)((0,a.Z)({},t.toJSON()),{},{f:"json"}),s=$(o),u=(0,a.Z)((0,a.Z)((0,a.Z)({},this.requestOptions),r),{},{query:s}),l="".concat(i,"/jobs/").concat(this.jobId,"/results/").concat(e);return(0,v["default"])(l,u).then((function(e){return H(e.data)}))}},{key:"fetchResultMapImageLayer",value:function(){var e=(0,n.Z)(regeneratorRuntime.mark((function e(){var t,n,a,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=(0,J.en)(this.sourceUrl),n=t.path,a=n.indexOf("/GPServer/"),i="".concat(n.substring(0,a),"/MapServer/jobs/").concat(this.jobId),e.next=4,Promise.all([r.e(9363),r.e(4813)]).then(r.bind(r,24813));case 4:return e.t0=e.sent.default,e.t1={url:i},e.abrupt("return",new e.t0(e.t1));case 7:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"waitForJobCompletion",value:function(){var e=(0,n.Z)(regeneratorRuntime.mark((function e(){var t,r,n,a,i,o=this,s=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=s.length>0&&void 0!==s[0]?s[0]:{},r=t.interval,n=void 0===r?1e3:r,a=t.signal,i=t.statusCallback,e.abrupt("return",new Promise((function(e,t){(0,ae.fu)(a,(function(){o._clearTimer(),t((0,ae.zE)())})),o._clearTimer();var r=setInterval((function(){o._timer||t((0,ae.zE)()),o.checkJobStatus(o.requestOptions).then((function(r){var n=r.jobStatus;switch(o.jobStatus=n,n){case"job-succeeded":o._clearTimer(),e(o);break;case"job-submitted":case"job-executing":case"job-waiting":case"job-new":i&&i(o);break;case"job-cancelled":case"job-cancelling":case"job-deleted":case"job-deleting":case"job-timed-out":case"job-failed":o._clearTimer(),t(o)}}))}),n);o._timer=r})));case 3:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}()},{key:"_clearTimer",value:function(){this._timer&&(clearInterval(this._timer),this._timer=null)}}]),l}(V.wq);(0,l._)([(0,p.Cb)()],oe.prototype,"jobId",void 0),(0,l._)([(0,p.Cb)({json:{read:ie.read}})],oe.prototype,"jobStatus",void 0),(0,l._)([(0,p.Cb)({type:[ee.Z]})],oe.prototype,"messages",void 0),(0,l._)([(0,p.Cb)()],oe.prototype,"requestOptions",void 0),(0,l._)([(0,p.Cb)({json:{write:!0}})],oe.prototype,"sourceUrl",void 0),oe=ne=(0,l._)([(0,y.j)("esri.rest.support.JobInfo")],oe);var se=oe;function ue(e,t,r,n){return le.apply(this,arguments)}function le(){return le=(0,n.Z)(regeneratorRuntime.mark((function e(t,r,n,a){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",(n=G.from(n||{}),X(t,"submitJob",n,r,a).then((function(e){var r=se.fromJSON(e.data);return r.sourceUrl=t,r}))));case 1:case"end":return e.stop()}}),e)}))),le.apply(this,arguments)}var ce=new c.Xn({PDF:"pdf",PNG32:"png32",PNG8:"png8",JPG:"jpg",GIF:"gif",EPS:"eps",SVG:"svg",SVGZ:"svgz"}),pe=(ce.fromJSON.bind(ce),ce.toJSON.bind(ce)),fe=new c.Xn({MAP_ONLY:"map-only","A3 Landscape":"a3-landscape","A3 Portrait":"a3-portrait","A4 Landscape":"a4-landscape","A4 Portrait":"a4-portrait","Letter ANSI A Landscape":"letter-ansi-a-landscape","Letter ANSI A Portrait":"letter-ansi-a-portrait","Tabloid ANSI B Landscape":"tabloid-ansi-b-landscape","Tabloid ANSI B Portrait":"tabloid-ansi-b-portrait"}),ye=(fe.fromJSON.bind(fe),fe.toJSON.bind(fe)),de="simple-marker",me="picture-marker",be="simple-line",he="simple-fill",ve="shield-label-symbol",ge="text";function xe(e,t){var r=t.graphic,n=t.renderer,a=t.symbol,i=a.type;if(i!==ge&&i!==ve&&"visualVariables"in n&&n.visualVariables){var o=n.getVisualVariablesForType("size"),s=n.getVisualVariablesForType("color"),u=n.getVisualVariablesForType("opacity"),l=n.getVisualVariablesForType("rotation"),c=o[0],p=s[0],f=u[0],y=l[0];if(c){var d=i===de?a.style:null,m=(0,Z.getSize)(c,r,{shape:d});null!=m&&(i===de?e.size=(0,w.Wz)(m):i===me?(e.width=(0,w.Wz)(m),e.height=(0,w.Wz)(m)):i===be?e.width=(0,w.Wz)(m):e.outline&&(e.outline.width=(0,w.Wz)(m)))}if(p){var b=(0,Z.getColor)(p,r);(b&&i===de||i===be||i===he)&&(e.color=b?b.toJSON():void 0)}if(f){var h=(0,Z.getOpacity)(f,r);null!=h&&e.color&&(e.color[3]=Math.round(255*h))}y&&(e.angle=-(0,Z.getRotationAngle)(n,r))}}function we(){return{layerDefinition:{name:"multipointLayer",geometryType:"esriGeometryMultipoint",drawingInfo:{renderer:null}},featureSet:{geometryType:"esriGeometryMultipoint",features:[]}}}function Se(){return{layerDefinition:{name:"polygonLayer",geometryType:"esriGeometryPolygon",drawingInfo:{renderer:null}},featureSet:{geometryType:"esriGeometryPolygon",features:[]}}}function ke(){return{layerDefinition:{name:"pointLayer",geometryType:"esriGeometryPoint",drawingInfo:{renderer:null}},featureSet:{geometryType:"esriGeometryPoint",features:[]}}}function Pe(){return{layerDefinition:{name:"polylineLayer",geometryType:"esriGeometryPolyline",drawingInfo:{renderer:null}},featureSet:{geometryType:"esriGeometryPolyline",features:[]}}}function Ze(e){var t,r,n,a,i,o,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:15,u=e.canvas.width,l=e.canvas.height,c=e.getImageData(0,0,u,l).data;e:for(r=l;r--;)for(t=u;t--;)if(c[4*(u*r+t)+3]>s){o=r;break e}if(!o)return null;e:for(t=u;t--;)for(r=o+1;r--;)if(c[4*(u*r+t)+3]>s){i=t;break e}e:for(t=0;t<=i;++t)for(r=o+1;r--;)if(c[4*(u*r+t)+3]>s){n=t;break e}e:for(r=0;r<=o;++r)for(t=n;t<=i;++t)if(c[4*(u*r+t)+3]>s){a=r;break e}return{x:n,y:a,width:i-n,height:o-a}}function De(e,t){var r=e.allLayerViews.items;if(t===e.scale)return r.filter((function(e){return!e.suspended}));var n,a=new Array,i=(0,m.Z)(r);try{for(i.s();!(n=i.n()).done;){var o=n.value;Ve(o.parent)&&!a.includes(o.parent)||!o.visible||t&&"isVisibleAtScale"in o&&!o.isVisibleAtScale(t)||a.push(o)}}catch(s){i.e(s)}finally{i.f()}return a}function Re(e){return e&&"bing-maps"===e.type}function Me(e){return e&&"blendMode"in e&&"effect"in e}function Ie(e){return e&&"csv"===e.type}function Ge(e){return e&&"feature"===e.type}function Le(e){return e&&"geojson"===e.type}function Te(e){return e&&"graphics"===e.type}function Oe(e){return e&&"group"===e.type}function Ve(e){return e&&"esri.views.2d.layers.GroupLayerView2D"===e.declaredClass}function _e(e){return e&&"imagery"===e.type}function Ce(e){return e&&"imagery-tile"===e.type}function Je(e){return e&&"kml"===e.type}function je(e){return e&&"map-image"===e.type}function Fe(e){return e&&"map-notes"===e.type}function Ne(e){return e&&"open-street-map"===e.type}function Ee(e){var t=e.layer;if(Me(t)){var r=t.blendMode;if((!r||"normal"===r)&&(t.effect||"featureEffect"in e&&e.featureEffect))return!0}return!1}function Ae(e){return e&&"stream"===e.type}function Ue(e){return e&&"tile"===e.type}function qe(e){return e&&"vector-tile"===e.type}function ze(e){return e&&"web-tile"===e.type}function We(e){return e&&"wms"===e.type}function Be(e){return e&&"wmts"===e.type}var Ke=function(e){(0,s.Z)(r,e);var t=(0,u.Z)(r);function r(e){var n;return(0,i.Z)(this,r),n=t.call(this,e),n.attributionVisible=!0,n.exportOptions={width:800,height:1100,dpi:96},n.forceFeatureAttributes=!1,n.format="png32",n.label=null,n.layout="map-only",n.layoutOptions=null,n.outScale=0,n.scalePreserved=!0,n.showLabels=!0,n}return(0,o.Z)(r)}(D.Z);(0,l._)([(0,p.Cb)()],Ke.prototype,"attributionVisible",void 0),(0,l._)([(0,p.Cb)()],Ke.prototype,"exportOptions",void 0),(0,l._)([(0,p.Cb)()],Ke.prototype,"forceFeatureAttributes",void 0),(0,l._)([(0,p.Cb)()],Ke.prototype,"format",void 0),(0,l._)([(0,p.Cb)()],Ke.prototype,"label",void 0),(0,l._)([(0,p.Cb)()],Ke.prototype,"layout",void 0),(0,l._)([(0,p.Cb)()],Ke.prototype,"layoutOptions",void 0),(0,l._)([(0,p.Cb)()],Ke.prototype,"outScale",void 0),(0,l._)([(0,p.Cb)()],Ke.prototype,"scalePreserved",void 0),(0,l._)([(0,p.Cb)()],Ke.prototype,"showLabels",void 0),Ke=(0,l._)([(0,y.j)("esri.rest.support.PrintTemplate")],Ke);var Xe=Ke,Qe=r(96412),Ye=r(69505),He={Feet:"ft",Kilometers:"km",Meters:"m",Miles:"mi"},$e=new c.Xn({esriFeet:"Feet",esriKilometers:"Kilometers",esriMeters:"Meters",esriMiles:"Miles"}),et=new c.Xn({esriExecutionTypeSynchronous:"sync",esriExecutionTypeAsynchronous:"async"}),tt=new Map;function rt(e,t,r){return nt.apply(this,arguments)}function nt(){return nt=(0,n.Z)(regeneratorRuntime.mark((function e(t,r,n){var a,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=ut(t),i=tt.get(a),e.abrupt("return",Promise.resolve().then((function(){return i?{data:i.gpMetadata}:(i={gpServerUrl:a,is11xService:!1,legendLayerNameMap:{},legendLayers:[]},(0,v["default"])(a,{query:{f:"json"}}))})).then((function(e){return i.gpMetadata=e.data,i.cimVersion=i.gpMetadata.cimVersion,i.is11xService=!!i.cimVersion,tt.set(a,i),at(r,i)})).then((function(e){var a,o=Kt(i),s=function(e){return"sync"===o?e.results&&e.results[0]&&e.results[0].value:a.fetchResultData("Output_File",null,n).then((function(e){return e.value}))};return"async"===o?ue(t,e,null,n).then((function(e){return a=e,e.waitForJobCompletion({interval:r.updateDelay}).then(s)})):te(t,e,null,n).then(s)})));case 3:case"end":return e.stop()}}),e)}))),nt.apply(this,arguments)}function at(e,t){return it.apply(this,arguments)}function it(){return it=(0,n.Z)(regeneratorRuntime.mark((function e(t,r){var n,a,i,o,s,u,l,c,p,f,y,d,m,b,h,v,x;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=r||{is11xService:!1,legendLayerNameMap:{},legendLayers:[]},n=t.template||new Xe,null==n.showLabels&&(n.showLabels=!0),a=n.exportOptions,o=ye(n.layout),a&&(i={dpi:a.dpi},("map_only"===o.toLowerCase()||""===o)&&(s=a.width,u=a.height,i.outputSize=[s,u])),l=n.layoutOptions,l&&("Miles"===l.scalebarUnit||"Kilometers"===l.scalebarUnit?(p="Kilometers",f="Miles"):"Meters"!==l.scalebarUnit&&"Feet"!==l.scalebarUnit||(p="Meters",f="Feet"),c={titleText:l.titleText,authorText:l.authorText,copyrightText:l.copyrightText,customTextElements:l.customTextElements,scaleBarOptions:{metricUnit:$e.toJSON(p),metricLabel:He[p],nonMetricUnit:$e.toJSON(f),nonMetricLabel:He[f]}}),y=null,null!=l&&l.legendLayers&&(y=l.legendLayers.map((function(e){r.legendLayerNameMap[e.layerId]=e.title;var t={id:e.layerId};return e.subLayerIds&&(t.subLayerIds=e.subLayerIds),t}))),e.next=12,ot(t,n,r);case 12:return d=e.sent,d.operationalLayers&&(m=new RegExp("[\\u4E00-\\u9FFF\\u0E00-\\u0E7F\\u0900-\\u097F\\u3040-\\u309F\\u30A0-\\u30FF\\u31F0-\\u31FF]"),b=/[\u0600-\u06FF]/,h=function(e){var t=e.text,r=e.font,n=r&&r.family&&r.family.toLowerCase();t&&r&&("arial"===n||"arial unicode ms"===n)&&(r.family=m.test(t)?"Arial Unicode MS":"Arial","normal"!==r.style&&b.test(t)&&(r.family="Arial Unicode MS"))},v=function(){throw new g.Z("print-task:cim-symbol-unsupported","CIMSymbol is not supported by a print service published from ArcMap")},d.operationalLayers.forEach((function(e){var t,n,a;null!=(t=e.featureCollection)&&t.layers?e.featureCollection.layers.forEach((function(e){var t,n,a,i;if(null!=(t=e.layerDefinition)&&null!=(n=t.drawingInfo)&&null!=(a=n.renderer)&&a.symbol){var o=e.layerDefinition.drawingInfo.renderer;"esriTS"===o.symbol.type?h(o.symbol):"CIMSymbolReference"!==o.symbol.type||r.is11xService||v()}null!=(i=e.featureSet)&&i.features&&e.featureSet.features.forEach((function(e){e.symbol&&("esriTS"===e.symbol.type?h(e.symbol):"CIMSymbolReference"!==e.symbol.type||r.is11xService||v())}))})):!r.is11xService&&null!=(n=e.layerDefinition)&&null!=(a=n.drawingInfo)&&a.renderer&&JSON.stringify(e.layerDefinition.drawingInfo.renderer).includes('"type":"CIMSymbolReference"')&&v()}))),t.outSpatialReference&&(d.mapOptions.spatialReference=t.outSpatialReference.toJSON()),Object.assign(d,{exportOptions:i,layoutOptions:c||{}}),Object.assign(d.layoutOptions,{legendOptions:{operationalLayers:null!=y?y:r.legendLayers.slice()}}),r.legendLayers.length=0,tt.set(r.gpServerUrl,r),x={Web_Map_as_JSON:JSON.stringify(d),Format:pe(n.format),Layout_Template:o},e.abrupt("return",(t.extraParameters&&Object.assign(x,t.extraParameters),x));case 17:case"end":return e.stop()}}),e)}))),it.apply(this,arguments)}function ot(e,t,r){return st.apply(this,arguments)}function st(){return st=(0,n.Z)(regeneratorRuntime.mark((function e(t,r,n){var a,i,o,s,u,l;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=t.view,i=a.spatialReference,e.next=4,lt(a,r,n);case 4:return e.t0=e.sent,o={operationalLayers:e.t0},s=n.ssExtent||t.extent||a.extent,i&&i.isWrappable&&(s=s.clone()._normalize(!0),i=s.spatialReference),o.mapOptions={extent:s&&s.toJSON(),spatialReference:i&&i.toJSON(),showAttribution:r.attributionVisible},n.ssExtent=null,a.background&&(o.background=a.background.toJSON()),a.rotation&&(o.mapOptions.rotation=-a.rotation),r.scalePreserved&&(o.mapOptions.scale=r.outScale||a.scale),(0,x.pC)(a.timeExtent)&&(u=(0,x.pC)(a.timeExtent.start)?a.timeExtent.start.getTime():null,l=(0,x.pC)(a.timeExtent.end)?a.timeExtent.end.getTime():null,o.mapOptions.time=[u,l]),e.abrupt("return",o);case 9:case"end":return e.stop()}}),e)}))),st.apply(this,arguments)}function ut(e){var t=e,r=t.lastIndexOf("/GPServer/");return r>0&&(t=t.slice(0,r+9)),t}function lt(e,t,r){return ct.apply(this,arguments)}function ct(){return ct=(0,n.Z)(regeneratorRuntime.mark((function e(t,r,n){var a,i,o,s,u,l,c,p,f,y;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:a=[],i={layerView:null,printTemplate:r,view:t},o=0,r.scalePreserved&&(o=r.outScale||t.scale),s=De(t,o),u=(0,m.Z)(s),e.prev=5,u.s();case 7:if((l=u.n()).done){e.next=128;break}if(c=l.value,p=c.layer,p.loaded&&!Oe(p)){e.next=12;break}return e.abrupt("continue",126);case 12:if(f=void 0,i.layerView=c,!Ee(c)){e.next=20;break}return e.next=17,Gt(p,i,n);case 17:e.t0=e.sent,e.next=124;break;case 20:if(!Re(p)){e.next=24;break}e.t1=pt(p),e.next=123;break;case 24:if(!Ie(p)){e.next=30;break}return e.next=27,ft(p,i,n);case 27:e.t2=e.sent,e.next=122;break;case 30:if(!Ge(p)){e.next=36;break}return e.next=33,bt(p,i,n);case 33:e.t3=e.sent,e.next=121;break;case 36:if(!Le(p)){e.next=42;break}return e.next=39,vt(p,i,n);case 39:e.t4=e.sent,e.next=120;break;case 42:if(!Te(p)){e.next=48;break}return e.next=45,xt(p,i,n);case 45:e.t5=e.sent,e.next=119;break;case 48:if(!_e(p)){e.next=52;break}e.t6=St(p,n),e.next=118;break;case 52:if(!Ce(p)){e.next=56;break}e.t7=kt(p,n),e.next=117;break;case 56:if(!Je(p)){e.next=62;break}return e.next=59,Pt(p,i,n);case 59:e.t8=e.sent,e.next=116;break;case 62:if(!je(p)){e.next=66;break}e.t9=Dt(p,i,n),e.next=115;break;case 66:if(!Fe(p)){e.next=72;break}return e.next=69,Rt(i,n);case 69:e.t10=e.sent,e.next=114;break;case 72:if(!Ne(p)){e.next=76;break}e.t11=It(),e.next=113;break;case 76:if(!Ae(p)){e.next=82;break}return e.next=79,Tt(p,i,n);case 79:e.t12=e.sent,e.next=112;break;case 82:if(!Ue(p)){e.next=86;break}e.t13=Vt(p),e.next=111;break;case 86:if(!qe(p)){e.next=92;break}return e.next=89,_t(p,i,n);case 89:e.t14=e.sent,e.next=110;break;case 92:if(!ze(p)){e.next=96;break}e.t15=Jt(p),e.next=109;break;case 96:if(!We(p)){e.next=100;break}e.t16=jt(p),e.next=108;break;case 100:if(!Be(p)){e.next=104;break}e.t17=Ft(p),e.next=107;break;case 104:return e.next=106,Gt(p,i,n);case 106:e.t17=e.sent;case 107:e.t16=e.t17;case 108:e.t15=e.t16;case 109:e.t14=e.t15;case 110:e.t13=e.t14;case 111:e.t12=e.t13;case 112:e.t11=e.t12;case 113:e.t10=e.t11;case 114:e.t9=e.t10;case 115:e.t8=e.t9;case 116:e.t7=e.t8;case 117:e.t6=e.t7;case 118:e.t5=e.t6;case 119:e.t4=e.t5;case 120:e.t3=e.t4;case 121:e.t2=e.t3;case 122:e.t1=e.t2;case 123:e.t0=e.t1;case 124:f=e.t0,f&&(Array.isArray(f)?a.push.apply(a,(0,d.Z)(f)):(f.id=p.id,f.title=n.legendLayerNameMap[p.id]||p.title,f.opacity=p.opacity,f.minScale=p.minScale||0,f.maxScale=p.maxScale||0,Me(p)&&p.blendMode&&"normal"!==p.blendMode&&(f.blendMode=p.blendMode),a.push(f)));case 126:e.next=7;break;case 128:e.next=133;break;case 130:e.prev=130,e.t18=e["catch"](5),u.e(e.t18);case 133:return e.prev=133,u.f(),e.finish(133);case 136:if(o&&a.forEach((function(e){e.minScale=0,e.maxScale=0})),!t.graphics||!t.graphics.length){e.next=141;break}return e.next=139,dt(null,t.graphics,r,n);case 139:y=e.sent,y&&a.push(y);case 141:return e.abrupt("return",a);case 142:case"end":return e.stop()}}),e,null,[[5,130,133,136]])}))),ct.apply(this,arguments)}function pt(e){return{culture:e.culture,key:e.key,type:"BingMaps"+("aerial"===e.style?"Aerial":"hybrid"===e.style?"Hybrid":"Road")}}function ft(e,t,r){return yt.apply(this,arguments)}function yt(){return yt=(0,n.Z)(regeneratorRuntime.mark((function e(t,r,n){var a,i,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.legendEnabled&&n.legendLayers.push({id:t.id}),a=r.layerView,i=r.printTemplate,n.is11xService&&!a.filter){e.next=11;break}return e.t0=dt,e.t1=t,e.next=7,Wt(a);case 7:return e.t2=e.sent,e.t3=i,e.t4=n,e.abrupt("return",(0,e.t0)(e.t1,e.t2,e.t3,e.t4));case 11:return e.abrupt("return",(o={type:"CSV"},t.write(o,{origin:"web-map"}),delete o.popupInfo,delete o.layerType,o.showLabels=i.showLabels&&t.labelsVisible,o));case 12:case"end":return e.stop()}}),e)}))),yt.apply(this,arguments)}function dt(e,t,r,n){return mt.apply(this,arguments)}function mt(){return mt=(0,n.Z)(regeneratorRuntime.mark((function e(t,r,n,a){var i,o,s,u,l,c,p,f,y,d,b,h,v,g,x,w,S,Z,D,R,M,I,G,L,T,O,V,_;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(o=Se(),s=Pe(),u=ke(),l=we(),c=ke(),c.layerDefinition.name="textLayer",delete c.layerDefinition.drawingInfo,t&&("esri.layers.FeatureLayer"===t.declaredClass||"esri.layers.StreamLayer"===t.declaredClass?o.layerDefinition.name=s.layerDefinition.name=u.layerDefinition.name=l.layerDefinition.name=a.legendLayerNameMap[t.id]||t.get("arcgisProps.title")||t.title:"esri.layers.GraphicsLayer"===t.declaredClass&&(r=t.graphics.items),t.renderer&&(p=t.renderer.toJSON(),o.layerDefinition.drawingInfo.renderer=p,s.layerDefinition.drawingInfo.renderer=p,u.layerDefinition.drawingInfo.renderer=p,l.layerDefinition.drawingInfo.renderer=p),n.showLabels&&t.labelsVisible&&"function"==typeof t.write&&(d=null==(f=t.write({},{origin:"web-map"}).layerDefinition)||null==(y=f.drawingInfo)?void 0:y.labelingInfo,d&&(i=!0,o.layerDefinition.drawingInfo.labelingInfo=d,s.layerDefinition.drawingInfo.labelingInfo=d,u.layerDefinition.drawingInfo.labelingInfo=d,l.layerDefinition.drawingInfo.labelingInfo=d))),null!=t&&t.renderer||i||(delete o.layerDefinition.drawingInfo,delete s.layerDefinition.drawingInfo,delete u.layerDefinition.drawingInfo,delete l.layerDefinition.drawingInfo),h=null==t?void 0:t.fieldsIndex,v=null==t?void 0:t.renderer,!h){e.next=17;break}if(g=new Set,e.t0=i,!e.t0){e.next=10;break}return e.next=10,(0,P.Mu)(g,t);case 10:if(e.t1=v&&"function"==typeof v.collectRequiredFields,!e.t1){e.next=14;break}return e.next=14,v.collectRequiredFields(g,h);case 14:b=Array.from(g),x=h.fields.map((function(e){return e.toJSON()})),o.layerDefinition.fields=x,s.layerDefinition.fields=x,u.layerDefinition.fields=x,l.layerDefinition.fields=x;case 17:w=r&&r.length,Z=0;case 19:if(!(Z<w)){e.next=51;break}if(R=r[Z]||r.getItemAt(Z),!1!==R.visible&&R.geometry){e.next=23;break}return e.abrupt("continue",48);case 23:if(S=R.toJSON(),S.hasOwnProperty("popupTemplate")&&delete S.popupTemplate,S.geometry&&S.geometry.z&&delete S.geometry.z,!S.symbol||!S.symbol.outline||"esriCLS"!==S.symbol.outline.type||a.is11xService){e.next=25;break}return e.abrupt("continue",48);case 25:if(!a.is11xService&&S.symbol&&S.symbol.outline&&S.symbol.outline.color&&S.symbol.outline.color[3]&&(S.symbol.outline.color[3]=255),M=t&&t.renderer&&("valueExpression"in t.renderer&&t.renderer.valueExpression||"hasVisualVariables"in t.renderer&&t.renderer.hasVisualVariables()),S.symbol||!t||!t.renderer||!M||a.is11xService){e.next=35;break}return I=t.renderer,e.next=31,I.getSymbolAsync(R);case 31:if(G=e.sent,G){e.next=34;break}return e.abrupt("continue",48);case 34:S.symbol=G.toJSON(),"hasVisualVariables"in I&&I.hasVisualVariables()&&xe(S.symbol,{renderer:I,graphic:R,symbol:G});case 35:if(e.t2=S.symbol,!e.t2){e.next=45;break}if(S.symbol.angle||delete S.symbol.angle,!Xt(S.symbol)){e.next=44;break}return e.next=41,At(S.symbol,a);case 41:S.symbol=e.sent,e.next=45;break;case 44:S.symbol.text&&delete S.attributes;case 45:if(n&&n.forceFeatureAttributes||null==(D=b)||!D.length){e.next=47;break}(function(){var e={};b.forEach((function(t){S.attributes&&S.attributes.hasOwnProperty(t)&&(e[t]=S.attributes[t])})),S.attributes=e})();case 47:"polygon"===R.geometry.type?o.featureSet.features.push(S):"polyline"===R.geometry.type?s.featureSet.features.push(S):"point"===R.geometry.type?S.symbol&&S.symbol.text?c.featureSet.features.push(S):u.featureSet.features.push(S):"multipoint"===R.geometry.type?l.featureSet.features.push(S):"extent"===R.geometry.type&&(S.geometry=k.Z.fromExtent(R.geometry).toJSON(),o.featureSet.features.push(S));case 48:Z++,e.next=19;break;case 51:L=[o,s,l,u,c].filter((function(e){return e.featureSet.features.length>0})),T=(0,m.Z)(L),e.prev=53,T.s();case 55:if((O=T.n()).done){e.next=66;break}if(V=O.value,_=V.featureSet.features.every((function(e){return e.symbol})),!_||n&&n.forceFeatureAttributes||V.featureSet.features.forEach((function(e){delete e.attributes})),_&&delete V.layerDefinition.drawingInfo,e.t3=V.layerDefinition.drawingInfo&&V.layerDefinition.drawingInfo.renderer,!e.t3){e.next=64;break}return e.next=64,qt(V.layerDefinition.drawingInfo.renderer,a);case 64:e.next=55;break;case 66:e.next=71;break;case 68:e.prev=68,e.t4=e["catch"](53),T.e(e.t4);case 71:return e.prev=71,T.f(),e.finish(71);case 74:return e.abrupt("return",L.length?{featureCollection:{layers:L},showLabels:i}:null);case 75:case"end":return e.stop()}}),e,null,[[53,68,71,74]])}))),mt.apply(this,arguments)}function bt(e,t,r){return ht.apply(this,arguments)}function ht(){return ht=(0,n.Z)(regeneratorRuntime.mark((function e(t,r,n){var a,i,o,s,u,l,c,p,f,y,d,m,b,h,v,g,x;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(s=t.renderer,u=parseFloat(n.cimVersion),!(t.featureReduction&&(!n.is11xService||u<2.9)||"dot-density"===(null==s?void 0:s.type)&&(!n.is11xService||u<2.6))){e.next=3;break}return e.abrupt("return",Gt(t,r,n));case 3:if(t.legendEnabled&&n.legendLayers.push({id:t.id}),l=r.layerView,c=r.printTemplate,p=r.view,f=s&&("valueExpression"in s&&s.valueExpression||"hasVisualVariables"in s&&s.hasVisualVariables()),y="feature-layer"!==(null==(a=t.source)?void 0:a.type)&&"ogc-feature"!==(null==(i=t.source)?void 0:i.type),!(!n.is11xService&&f||l.filter||y)&&s&&(!("field"in s)||null==s.field||"string"==typeof s.field&&t.getField(s.field))){e.next=14;break}return e.next=8,Wt(l);case 8:return d=e.sent,e.next=11,dt(t,d,c,n);case 11:o=e.sent,e.next=29;break;case 14:if(o={id:(x=t.write()).id,title:x.title,opacity:x.opacity,minScale:x.minScale,maxScale:x.maxScale,url:x.url,layerType:x.layerType,customParameters:x.customParameters,layerDefinition:x.layerDefinition},o.showLabels=c.showLabels&&t.labelsVisible,Nt(o,t),e.t0=null!=(m=o.layerDefinition)&&null!=(b=m.drawingInfo)&&b.renderer,!e.t0){e.next=24;break}return delete o.layerDefinition.minScale,delete o.layerDefinition.maxScale,e.next=23,qt(o.layerDefinition.drawingInfo.renderer,n);case 23:e.t0="visualVariables"in s&&s.visualVariables&&s.visualVariables[0];case 24:if(!e.t0){e.next=27;break}h=s.visualVariables[0],"size"===h.type&&h.maxSize&&"number"!=typeof h.maxSize&&h.minSize&&"number"!=typeof h.minSize&&(v=(0,Z.getSizeRangeAtScale)(h,p.scale),o.layerDefinition.drawingInfo.renderer.visualVariables[0].minSize=v.minSize,o.layerDefinition.drawingInfo.renderer.visualVariables[0].maxSize=v.maxSize);case 27:g=(0,Ye.cx)(l),g&&(o.layerDefinition||(o.layerDefinition={}),o.layerDefinition.definitionExpression=o.layerDefinition.definitionExpression?"(".concat(o.layerDefinition.definitionExpression,") AND (").concat(g,")"):g);case 29:return e.abrupt("return",o);case 30:case"end":return e.stop()}}),e)}))),ht.apply(this,arguments)}function vt(e,t,r){return gt.apply(this,arguments)}function gt(){return gt=(0,n.Z)(regeneratorRuntime.mark((function e(t,r,n){var a,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=r.layerView,i=r.printTemplate,t.legendEnabled&&n.legendLayers.push({id:t.id}),e.t0=dt,e.t1=t,e.next=6,Wt(a);case 6:return e.t2=e.sent,e.t3=i,e.t4=n,e.abrupt("return",(0,e.t0)(e.t1,e.t2,e.t3,e.t4));case 10:case"end":return e.stop()}}),e)}))),gt.apply(this,arguments)}function xt(e,t,r){return wt.apply(this,arguments)}function wt(){return wt=(0,n.Z)(regeneratorRuntime.mark((function e(t,r,n){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=r.printTemplate,e.abrupt("return",dt(t,null,a,n));case 2:case"end":return e.stop()}}),e)}))),wt.apply(this,arguments)}function St(e,t){e.legendEnabled&&t.legendLayers.push({id:e.id});var r,n={layerType:(r=e.write()).layerType,customParameters:r.customParameters};if(n.bandIds=e.bandIds,n.compressionQuality=e.compressionQuality,n.format=e.format,n.interpolation=e.interpolation,(e.mosaicRule||e.definitionExpression)&&(n.mosaicRule=e.exportImageServiceParameters.mosaicRule.toJSON()),e.renderingRule||e.renderer)if(t.is11xService)e.renderingRule&&(n.renderingRule=e.renderingRule.toJSON()),e.renderer&&(n.layerDefinition=n.layerDefinition||{},n.layerDefinition.drawingInfo=n.layerDefinition.drawingInfo||{},n.layerDefinition.drawingInfo.renderer=e.renderer.toJSON());else{var a=e.exportImageServiceParameters.combineRendererWithRenderingRule();a&&(n.renderingRule=a.toJSON())}return Nt(n,e),n}function kt(e,t){e.legendEnabled&&t.legendLayers.push({id:e.id});var r,n={bandIds:(r=e.write()||{}).bandIds,customParameters:r.customParameters,interpolation:r.interpolation,layerDefinition:r.layerDefinition};return n.layerType="ArcGISImageServiceLayer",Nt(n,e),n}function Pt(e,t,r){return Zt.apply(this,arguments)}function Zt(){return Zt=(0,n.Z)(regeneratorRuntime.mark((function e(t,r,n){var i,o,s,u,l,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(i=r.printTemplate,!n.is11xService){e.next=4;break}return o={type:"kml"},e.abrupt("return",(t.write(o,{origin:"web-map"}),delete o.layerType,o.url=(0,S.Fv)(t.url),o));case 4:return s=[],u=r.layerView,u.allVisibleMapImages.forEach((function(e,r){var n={id:"".concat(t.id,"_image").concat(r),type:"image",title:t.id,minScale:t.minScale||0,maxScale:t.maxScale||0,opacity:t.opacity,extent:e.extent};"data:image/png;base64,"===e.href.substr(0,22)?n.imageData=e.href.substr(22):n.url=e.href,s.push(n)})),l=[].concat((0,d.Z)(u.allVisiblePoints.items),(0,d.Z)(u.allVisiblePolylines.items),(0,d.Z)(u.allVisiblePolygons.items)),e.t0=a.Z,e.t1={id:t.id},e.next=11,dt(null,l,i,n);case 11:return e.t2=e.sent,c=(0,e.t0)(e.t1,e.t2),e.abrupt("return",(s.push(c),s));case 14:case"end":return e.stop()}}),e)}))),Zt.apply(this,arguments)}function Dt(e,t,r){var n,a,i=t.view,o={id:e.id,subLayerIds:[]},s=[],u=i.scale,l=function e(t){var r=0===u,n=0===t.minScale||u<=t.minScale,a=0===t.maxScale||u>=t.maxScale;if(t.visible&&(r||n&&a))if(t.sublayers)t.sublayers.forEach(e);else{var i=t.toExportImageJSON(),l={id:t.id,name:t.title,layerDefinition:{drawingInfo:i.drawingInfo,definitionExpression:i.definitionExpression,source:i.source}};s.unshift(l),o.subLayerIds.push(t.id)}};return e.sublayers&&e.sublayers.forEach(l),s.length&&(s=s.map((function(e){var t=e.id,r=e.name,n=e.layerDefinition;return{id:t,name:r,layerDefinition:n}})),n={layerType:(a=e.write()).layerType,customParameters:a.customParameters},n.layers=s,n.visibleLayers=e.capabilities.exportMap.supportsDynamicLayers?void 0:o.subLayerIds,Nt(n,e),e.legendEnabled&&r.legendLayers.push(o)),n}function Rt(e,t){return Mt.apply(this,arguments)}function Mt(){return Mt=(0,n.Z)(regeneratorRuntime.mark((function e(t,r){var n,a,i,o,s,u,l,c,p,f,y,b;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=t.layerView,a=t.printTemplate,i=[],o=n.layer,!(0,x.pC)(o.featureCollections)){e.next=24;break}s=(0,m.Z)(o.featureCollections),e.prev=4,s.s();case 6:if((u=s.n()).done){e.next=14;break}return l=u.value,e.next=10,dt(l,l.source,a,r);case 10:c=e.sent,c&&i.push.apply(i,(0,d.Z)(c.featureCollection.layers));case 12:e.next=6;break;case 14:e.next=19;break;case 16:e.prev=16,e.t0=e["catch"](4),s.e(e.t0);case 19:return e.prev=19,s.f(),e.finish(19);case 22:e.next=44;break;case 24:if(!(0,x.pC)(o.sublayers)){e.next=44;break}p=(0,m.Z)(o.sublayers),e.prev=26,p.s();case 28:if((f=p.n()).done){e.next=36;break}return y=f.value,e.next=32,dt(null,y.graphics,a,r);case 32:b=e.sent,b&&i.push.apply(i,(0,d.Z)(b.featureCollection.layers));case 34:e.next=28;break;case 36:e.next=41;break;case 38:e.prev=38,e.t1=e["catch"](26),p.e(e.t1);case 41:return e.prev=41,p.f(),e.finish(41);case 44:return e.abrupt("return",{featureCollection:{layers:i}});case 45:case"end":return e.stop()}}),e,null,[[4,16,19,22],[26,38,41,44]])}))),Mt.apply(this,arguments)}function It(){return{type:"OpenStreetMap"}}function Gt(e,t,r){return Lt.apply(this,arguments)}function Lt(){return Lt=(0,n.Z)(regeneratorRuntime.mark((function e(t,r,n){var a,i,o,s,u,l,c,p,f,y,d,m,b;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=r.printTemplate,i=r.view,o={type:"image"},s={format:"png",ignoreBackground:!0,layers:[t],rotation:0},u=n.ssExtent||i.extent.clone(),l=96,c=!0,p=!0,a.exportOptions&&(f=a.exportOptions,f.dpi>0&&(l=f.dpi),f.width>0&&(c=f.width%2==i.width%2),f.height>0&&(p=f.height%2==i.height%2)),"map-only"!==a.layout||!a.scalePreserved||a.outScale&&a.outScale!==i.scale||96!==l||c&&p||(s.area={x:0,y:0,width:i.width,height:i.height},c||(s.area.width-=1),p||(s.area.height-=1),n.ssExtent)||(y=i.toMap((0,w.vW)(s.area.width,s.area.height)),u.ymin=y.y,u.xmax=y.x,n.ssExtent=u),o.extent=u.clone()._normalize(!0).toJSON(),e.next=8,i.takeScreenshot(s);case 8:return d=e.sent,m=(0,S.sJ)(d.dataUrl),b=m.data,e.abrupt("return",(o.imageData=b,o));case 12:case"end":return e.stop()}}),e)}))),Lt.apply(this,arguments)}function Tt(e,t,r){return Ot.apply(this,arguments)}function Ot(){return Ot=(0,n.Z)(regeneratorRuntime.mark((function e(t,r,n){var a,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=r.layerView,i=r.printTemplate,t.legendEnabled&&n.legendLayers.push({id:t.id}),e.t0=dt,e.t1=t,e.next=6,Wt(a);case 6:return e.t2=e.sent,e.t3=i,e.t4=n,e.abrupt("return",(0,e.t0)(e.t1,e.t2,e.t3,e.t4));case 10:case"end":return e.stop()}}),e)}))),Ot.apply(this,arguments)}function Vt(e){var t,r={layerType:(t=e.write()).layerType,customParameters:t.customParameters};return Nt(r,e),r}function _t(e,t,r){return Ct.apply(this,arguments)}function Ct(){return Ct=(0,n.Z)(regeneratorRuntime.mark((function e(t,r,n){var a,i,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!(n.is11xService&&t.serviceUrl&&t.styleUrl)){e.next=5;break}if(a=Et(t.styleUrl,t.apiKey),i=Et(t.serviceUrl,t.apiKey),(a||i)&&"2.1.0"===n.cimVersion){e.next=5;break}return o={type:"VectorTileLayer"},e.abrupt("return",(o.styleUrl=(0,S.Fv)(t.styleUrl),o.token=a,i!==a&&(o.additionalTokens=[{url:t.serviceUrl,token:i}]),o));case 5:return e.abrupt("return",Gt(t,r,n));case 6:case"end":return e.stop()}}),e)}))),Ct.apply(this,arguments)}function Jt(e){var t={type:"WebTiledLayer",urlTemplate:e.urlTemplate.replace(/\${/g,"{"),credits:e.copyright};return e.subDomains&&e.subDomains.length>0&&(t.subDomains=e.subDomains),t}function jt(e){var t,r=[],n=function e(t){t.visible&&(t.sublayers?t.sublayers.forEach(e):t.name&&r.unshift(t.name))};return e.sublayers&&e.sublayers.forEach(n),r.length&&(t={type:"wms",customLayerParameters:e.customLayerParameters,customParameters:e.customParameters,transparentBackground:e.imageTransparency,visibleLayers:r,url:(0,S.Fv)(e.url),version:e.version}),t}function Ft(e){var t=e.activeLayer;return{type:"wmts",customLayerParameters:e.customLayerParameters,customParameters:e.customParameters,format:t.imageFormat,layer:t.id,style:t.styleId,tileMatrixSet:t.tileMatrixSetId,url:(0,S.Fv)(e.url)}}function Nt(e,t){t.url&&(e.url=(0,S.Fv)(e.url||t.url),e.token=Et(e.url,t.apiKey))}function Et(e,t){var r,n;return(0,Qe.r)(e)&&(t||b.Z.apiKey)?t||b.Z.apiKey:null==(r=h.id)||null==(n=r.findCredential(e))?void 0:n.token}function At(e,t){return Ut.apply(this,arguments)}function Ut(){return Ut=(0,n.Z)(regeneratorRuntime.mark((function e(t,r){var n,a,i,o,s,u,l,c,p,f,y,d,m,b,h;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(r.canvas||(r.canvas=document.createElement("canvas")),n=1024,r.canvas.width=n,r.canvas.height=n,a=r.canvas.getContext("2d"),!t.path){e.next=20;break}if(u=new Path2D(t.path),u.closePath(),a.fillStyle=Array.isArray(t.color)?"rgba(".concat(t.color[0],",").concat(t.color[1],",").concat(t.color[2],",").concat(t.color[3]/255,")"):"rgb(0,0,0)",a.fill(u),l=Ze(a),l){e.next=10;break}return e.abrupt("return",null);case 10:a.clearRect(0,0,n,n),c=(0,w.F2)(t.size)/Math.max(l.width,l.height),a.scale(c,c),p=n/c,f=p/2-l.width/2-l.x,y=p/2-l.height/2-l.y,a.translate(f,y),Array.isArray(t.color)&&a.fill(u),null!=(s=t.outline)&&s.width&&Array.isArray(t.outline.color)&&(d=t.outline,a.lineWidth=(0,w.F2)(d.width)/c,a.lineJoin="round",a.strokeStyle="rgba(".concat(d.color[0],",").concat(d.color[1],",").concat(d.color[2],",").concat(d.color[3]/255,")"),a.stroke(u),l.width+=a.lineWidth,l.height+=a.lineWidth),l.width*=c,l.height*=c,m=a.getImageData(n/2-l.width/2,n/2-l.height/2,Math.ceil(l.width),Math.ceil(l.height)),i=m.width,o=m.height,a.canvas.width=i,a.canvas.height=o,a.putImageData(m,0,0),e.next=25;break;case 20:return b="image/svg+xml"===t.contentType?"data:image/svg+xml;base64,"+t.imageData:t.url,e.next=23,(0,v["default"])(b,{responseType:"image"});case 23:h=e.sent.data,i=(0,w.F2)(t.width),o=(0,w.F2)(t.height),a.canvas.width=i,a.canvas.height=o,a.drawImage(h,0,0,a.canvas.width,a.canvas.height);case 25:return e.abrupt("return",{type:"esriPMS",imageData:a.canvas.toDataURL("image/png").substr(22),angle:t.angle,contentType:"image/png",height:c(o),width:c(i),xoffset:t.xoffset,yoffset:t.yoffset});case 26:case"end":return e.stop()}}),e)}))),Ut.apply(this,arguments)}function qt(e,t){return zt.apply(this,arguments)}function zt(){return zt=(0,n.Z)(regeneratorRuntime.mark((function e(t,r){var n,a,i,o,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=t.type,"simple"!==n||!Xt(t.symbol)){e.next=7;break}return e.next=4,At(t.symbol,r);case 4:t.symbol=e.sent,e.next=35;break;case 7:if("uniqueValue"!==n&&"classBreaks"!==n){e.next=35;break}if(e.t0=Xt(t.defaultSymbol),!e.t0){e.next=13;break}return e.next=12,At(t.defaultSymbol,r);case 12:t.defaultSymbol=e.sent;case 13:if(a=t["uniqueValue"===n?"uniqueValueInfos":"classBreakInfos"],!a){e.next=35;break}i=(0,m.Z)(a),e.prev=16,i.s();case 18:if((o=i.n()).done){e.next=27;break}if(s=o.value,e.t1=Xt(s.symbol),!e.t1){e.next=25;break}return e.next=24,At(s.symbol,r);case 24:s.symbol=e.sent;case 25:e.next=18;break;case 27:e.next=32;break;case 29:e.prev=29,e.t2=e["catch"](16),i.e(e.t2);case 32:return e.prev=32,i.f(),e.finish(32);case 35:case"end":return e.stop()}}),e,null,[[16,29,32,35]])}))),zt.apply(this,arguments)}function Wt(e){return Bt.apply(this,arguments)}function Bt(){return Bt=(0,n.Z)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",t.queryFeatures(t.createQuery()).then((function(e){return e.features})));case 1:case"end":return e.stop()}}),e)}))),Bt.apply(this,arguments)}function Kt(e){return e.gpMetadata&&e.gpMetadata.executionType?et.fromJSON(e.gpMetadata.executionType):"sync"}function Xt(e){return e&&(e.path||"image/svg+xml"===e.contentType||e.url&&e.url.endsWith(".svg"))}var Qt=r(31760),Yt=new c.Xn({esriExecutionTypeSynchronous:"sync",esriExecutionTypeAsynchronous:"async"}),Ht=function(e){(0,s.Z)(r,e);var t=(0,u.Z)(r);function r(){var e;(0,i.Z)(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),e._gpMetadata=null,e.updateDelay=1e3,e}return(0,o.Z)(r,[{key:"mode",get:function(){return this._gpMetadata&&this._gpMetadata.executionType?Yt.fromJSON(this._gpMetadata.executionType):"sync"}},{key:"execute",value:function(e,t){return e&&(e.updateDelay=this.updateDelay),rt(this.url,e,(0,a.Z)((0,a.Z)({},this.requestOptions),t))}},{key:"_getGpPrintParams",value:function(){var e=(0,n.Z)(regeneratorRuntime.mark((function e(t){var r,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=ut(this.url),n=tt.get(r),e.abrupt("return",at(t,n));case 2:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()}]),r}(Qt.Z);(0,l._)([(0,p.Cb)()],Ht.prototype,"_gpMetadata",void 0),(0,l._)([(0,p.Cb)({readOnly:!0})],Ht.prototype,"mode",null),(0,l._)([(0,p.Cb)()],Ht.prototype,"updateDelay",void 0),Ht=(0,l._)([(0,y.j)("esri.tasks.PrintTask")],Ht);var $t=Ht}}]);