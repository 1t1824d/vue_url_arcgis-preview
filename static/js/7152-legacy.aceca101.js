"use strict";(self["webpackChunkvue_url_arcgis"]=self["webpackChunkvue_url_arcgis"]||[]).push([[7152],{67152:function(e,t,r){r.r(t),r.d(t,{default:function(){return L},inferFieldType:function(){return z},inferFields:function(){return J},inferLocationInfo:function(){return Y}});var n=r(62032),i=r(4367),a=r(2394),u=r(16198),s=r(92751),o=r(76133),l=(r(41539),r(78783),r(33948),r(21249),r(57327),r(68309),r(73210),r(74916),r(23123),r(9653),r(51532),r(69826),r(26699),r(32023),r(77601),r(33161),r(15306),r(44048),r(4723),r(24603),r(28450),r(88386),r(39714),r(78975),r(75065),r(35680)),c=r(25585),p=r(87441),d=r(48375),f=r(24446),h=r(58476),m=r(98267),y=r(630),v=r(71563),g=r(8470),x=r(39423),w=r(82409),b=r(125),F=r(76400),k=r(62415),_=regeneratorRuntime.mark(R),I=regeneratorRuntime.mark(D),N=/^\s*"([\S\s]*)"\s*$/,Z=/""/g,T="\n",E=[","," ",";","|","\t"];function R(e,t,r){var n,i,a;return regeneratorRuntime.wrap((function(u){while(1)switch(u.prev=u.next){case 0:n=0;case 1:if(!(n<=e.length)){u.next=10;break}if(i=e.indexOf(t,n),a=e.substring(n,i>-1?i:void 0),n+=a.length+t.length,u.t0=r&&!a.trim(),u.t0){u.next=8;break}return u.next=8,a;case 8:u.next=1;break;case 10:case"end":return u.stop()}}),_)}function S(e){var t=e.includes("\r\n")?"\r\n":T;return R(e,t,!0)}function q(e,t){return R(e,t,!1)}function C(e){var t,r=e.trim(),i=0,a="",u=(0,n.Z)(E);try{for(u.s();!(t=u.n()).done;){var s=t.value,o=r.split(s).length;o>i&&(i=o,a=s)}}catch(l){u.e(l)}finally{u.f()}return""===a?null:a}function D(e,t,r){var i,a,u,s,o,l,c,p,d,f,h,m,y,v,g=arguments;return regeneratorRuntime.wrap((function(x){while(1)switch(x.prev=x.next){case 0:i=g.length>3&&void 0!==g[3]?g[3]:function(){return Object.create(null)},a="",u="",s=0,o=i(),l=0,c=(0,n.Z)(e),x.prev=3,c.s();case 5:if((p=c.n()).done){x.next=47;break}d=p.value,f=q(d,r),h=(0,n.Z)(f),x.prev=9,h.s();case 11:if((m=h.n()).done){x.next=29;break}if(y=m.value,a+=u+y,u="",s+=O(y),s%2!=0){x.next=26;break}if(!(s>0)){x.next=22;break}if(v=N.exec(a),v){x.next=19;break}return o=i(),l=0,a="",s=0,x.abrupt("continue",45);case 19:o[t[l]]=v[1].replace(Z,'"'),l++,x.next=23;break;case 22:o[t[l]]=a,l++;case 23:a="",s=0,x.next=27;break;case 26:u=r;case 27:x.next=11;break;case 29:x.next=34;break;case 31:x.prev=31,x.t0=x["catch"](9),h.e(x.t0);case 34:return x.prev=34,h.f(),x.finish(34);case 37:if(0!==s){x.next=44;break}return x.next=40,o;case 40:o=i(),l=0,x.next=45;break;case 44:u=T;case 45:x.next=5;break;case 47:x.next=52;break;case 49:x.prev=49,x.t1=x["catch"](3),c.e(x.t1);case 52:return x.prev=52,c.f(),x.finish(52);case 55:case"end":return x.stop()}}),I,null,[[3,49,52,55],[9,31,34,37]])}function O(e){var t=0,r=0;for(r=e.indexOf('"',r);r>=0;)t++,r=e.indexOf('"',r+1);return t}var j=r(94288),P=r(83683),G=r(63390),V=r(7730),A=(0,j.bU)("esriGeometryPoint"),M=["csv"],Q=[0,0],U=(0,s.Z)((function e(t,r){(0,o.Z)(this,e),this.x=t,this.y=r})),L=function(){function e(){var t=this;(0,o.Z)(this,e),this._queryEngine=null,this._snapshotFeatures=function(){var e=(0,u.Z)(regeneratorRuntime.mark((function e(r){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t._fetch(r);case 2:return n=e.sent,e.abrupt("return",t._createFeatures(n));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}return(0,s.Z)(e,[{key:"destroy",value:function(){var e;null==(e=this._queryEngine)||e.destroy(),this._queryEngine=null}},{key:"load",value:function(){var e=(0,u.Z)(regeneratorRuntime.mark((function e(t){var r,n,i,u,s,o,l,c,p,d,f=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=f.length>1&&void 0!==f[1]?f[1]:{},this.loadOptions=t,e.next=4,Promise.all([this._fetch(r.signal),this._checkProjection(null==t||null==(n=t.parsingOptions)?void 0:n.spatialReference)]);case 4:return i=e.sent,u=(0,a.Z)(i,1),s=u[0],o=B(s,t),this.locationInfo=o.locationInfo,this.delimiter=o.delimiter,this._queryEngine=this._createQueryEngine(o),e.next=11,this._createFeatures(s);case 11:return l=e.sent,this._queryEngine.featureStore.addMany(l),o.layerDefinition.extent=this._queryEngine.fullExtent,o.layerDefinition.timeInfo&&(c=this._queryEngine.timeExtent,p=c.start,d=c.end,o.layerDefinition.timeInfo.timeExtent=[p,d]),e.abrupt("return",o);case 14:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"applyEdits",value:function(){var e=(0,u.Z)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:throw new c.Z("csv-layer:editing-not-supported","applyEdits() is not supported on CSVLayer");case 1:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}()},{key:"queryFeatures",value:function(){var e=(0,u.Z)(regeneratorRuntime.mark((function e(){var t,r,n=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:{},r=n.length>1&&void 0!==n[1]?n[1]:{},e.next=4,this._waitSnapshotComplete();case 4:return e.abrupt("return",this._queryEngine.executeQuery(t,r.signal));case 5:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"queryFeatureCount",value:function(){var e=(0,u.Z)(regeneratorRuntime.mark((function e(){var t,r,n=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:{},r=n.length>1&&void 0!==n[1]?n[1]:{},e.next=4,this._waitSnapshotComplete();case 4:return e.abrupt("return",this._queryEngine.executeQueryForCount(t,r.signal));case 5:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"queryObjectIds",value:function(){var e=(0,u.Z)(regeneratorRuntime.mark((function e(){var t,r,n=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:{},r=n.length>1&&void 0!==n[1]?n[1]:{},e.next=4,this._waitSnapshotComplete();case 4:return e.abrupt("return",this._queryEngine.executeQueryForIds(t,r.signal));case 5:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"queryExtent",value:function(){var e=(0,u.Z)(regeneratorRuntime.mark((function e(){var t,r,n=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:{},r=n.length>1&&void 0!==n[1]?n[1]:{},e.next=4,this._waitSnapshotComplete();case 4:return e.abrupt("return",this._queryEngine.executeQueryForExtent(t,r.signal));case 5:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"querySnapping",value:function(){var e=(0,u.Z)(regeneratorRuntime.mark((function e(t){var r,n=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=n.length>1&&void 0!==n[1]?n[1]:{},e.next=3,this._waitSnapshotComplete();case 3:return e.abrupt("return",this._queryEngine.executeQueryForSnapping(t,r.signal));case 4:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"refresh",value:function(){var e=(0,u.Z)(regeneratorRuntime.mark((function e(t){var r,n=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.loadOptions.customParameters=t,null==(r=this._snapshotTask)||r.abort(),this._snapshotTask=(0,f.vr)(this._snapshotFeatures),this._snapshotTask.promise.then((function(e){n._queryEngine.featureStore.clear(),e&&n._queryEngine.featureStore.addMany(e)}),(function(e){n._queryEngine.featureStore.clear(),(0,f.D_)(e)||p.Z.getLogger("esri.layers.CSVLayer").error(new c.Z("csv-layer:refresh","An error occurred during refresh",{error:e}))})),e.next=6,this._waitSnapshotComplete();case 6:return e.abrupt("return",{extent:this._queryEngine.fullExtent,timeExtent:this._queryEngine.timeExtent});case 7:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"_waitSnapshotComplete",value:function(){var e=(0,u.Z)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!this._snapshotTask||this._snapshotTask.finished){e.next=9;break}return e.prev=1,e.next=4,this._snapshotTask.promise;case 4:e.next=8;break;case 6:e.prev=6,e.t0=e["catch"](1);case 8:return e.abrupt("return",this._waitSnapshotComplete());case 9:case"end":return e.stop()}}),e,this,[[1,6]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"_fetch",value:function(){var e=(0,u.Z)(regeneratorRuntime.mark((function e(t){var r,n,a,u;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(r=this.loadOptions,n=r.url,a=r.customParameters,n){e.next=3;break}throw new c.Z("csv-layer:invalid-source","url not defined");case 3:return u=(0,h.mN)(n),e.next=6,(0,l["default"])(u.path,{query:(0,i.Z)((0,i.Z)({},u.query),a),responseType:"text",signal:t});case 6:return e.abrupt("return",e.sent.data);case 7:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"_createQueryEngine",value:function(e){var t=e.layerDefinition,r=t.objectIdField,n=t.fields,i=t.extent,a=t.timeInfo,u=new b.Z({geometryType:"esriGeometryPoint",hasM:!1,hasZ:!1});return new k.Z({fields:n,geometryType:"esriGeometryPoint",hasM:!1,hasZ:!1,timeInfo:a,objectIdField:r,spatialReference:i.spatialReference||{wkid:4326},cacheSpatialQueries:!0,featureStore:u})}},{key:"_createFeatures",value:function(){var e=(0,u.Z)(regeneratorRuntime.mark((function e(t){var r,i,u,s,o,l,c,p,d,f,h,b,F,k,_,I,N,Z,T,E,R,q,C,O,P,A,M,L,B,W,$,Y,J,z,H,K,te;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:r=this.locationInfo,i=r.latitudeFieldName,u=r.longitudeFieldName,s=this._queryEngine,o=s.objectIdField,l=s.fieldsIndex,c=s.spatialReference,p=[],d=[],f=l.fields.filter((function(e){return e.name!==o})).map((function(e){return e.name})),h=0,b=S(t),b.next(),F={},k=(0,n.Z)(l.fields);try{for(k.s();!(_=k.n()).done;)I=_.value,"esriFieldTypeOID"!==I.type&&"esriFieldTypeGlobalID"!==I.type&&(N=(0,G.os)(I),void 0!==N&&(F[I.name]=N))}catch(re){k.e(re)}finally{k.f()}Z=D(b,f,this.delimiter,(0,j.Dm)(F,o)),T=(0,n.Z)(Z);try{for(T.s();!(E=T.n()).done;)if(R=E.value,q=this._parseCoordinateValue(R[i]),C=this._parseCoordinateValue(R[u]),null!=C&&null!=q&&!isNaN(q)&&!isNaN(C)){for(O in R[i]=q,R[u]=C,R)O!==i&&O!==u&&(l.isDateField(O)?(P=new Date(R[O]),R[O]=X(P,R[O])?P.getTime():null):l.isNumericField(O)&&(A=ee(R[O]),isNaN(A)?R[O]=null:R[O]=A));R[o]=h,h++,p.push(new U(C,q)),d.push(R)}}catch(re){T.e(re)}finally{T.f()}if(!(0,v.fS)({wkid:4326},c))if((0,v.sS)(c)){M=(0,n.Z)(p);try{for(M.s();!(L=M.n()).done;)B=L.value,W=(0,g.hG)(B.x,B.y,Q),$=(0,a.Z)(W,2),B.x=$[0],B.y=$[1]}catch(re){M.e(re)}finally{M.f()}}else p=(0,m.oj)(y.N,p,V.Z.WGS84,c,null);for(Y=[],J=0;J<p.length;J++)z=p[J],H=z.x,K=z.y,te=d[J],te[o]=J+1,Y.push(new x.ZP(new w.Z([],[H,K]),te,null,te[o]));return e.abrupt("return",Y);case 16:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"_parseCoordinateValue",value:function(e){if(null==e||""===e)return null;var t=ee(e);return(isNaN(t)||Math.abs(t)>181)&&(t=parseFloat(e)),t}},{key:"_checkProjection",value:function(){var e=(0,u.Z)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,F._W)(v.Zn,t);case 3:e.next=8;break;case 5:throw e.prev=5,e.t0=e["catch"](0),new c.Z("csv-layer:projection-not-supported","Projection not supported");case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));function t(t){return e.apply(this,arguments)}return t}()}]),e}();function B(e,t){var r=t.parsingOptions||{},i={delimiter:r.delimiter,layerDefinition:null,locationInfo:{latitudeFieldName:r.latitudeField,longitudeFieldName:r.longitudeField}},a=S(e),u=a.next().value;if(!u)throw new c.Z("csv-layer:empty-csv","CSV is empty",{csv:e});if(u=u.trim(),!r.delimiter){var s=C(u);if(!s)throw new c.Z("csv-layer:invalid-delimiter","Unable to detect the delimiter from CSV");i.delimiter=s}var o=u.split(i.delimiter).filter((function(e){return!!e})),l=i.layerDefinition={name:(0,h.vt)(t.url,M)||"csv",drawingInfo:A,geometryType:"esriGeometryPoint",objectIdField:null,fields:[],timeInfo:r.timeInfo,extent:{xmin:Number.POSITIVE_INFINITY,ymin:Number.POSITIVE_INFINITY,xmax:Number.NEGATIVE_INFINITY,ymax:Number.NEGATIVE_INFINITY,spatialReference:r.spatialReference||{wkid:102100}}};if(!r.latitudeField||!r.longitudeField){var p=Y(o);if(!r.longitudeField&&!p.longitudeFieldName||!r.latitudeField&&!p.latitudeFieldName)throw new c.Z("csv-layer:location-fields-not-found","Unable to identify latitude and longitude fields from the CSV file");i.locationInfo={longitudeFieldName:r.longitudeField||p.longitudeFieldName,latitudeFieldName:r.latitudeField||p.latitudeFieldName}}var d=J(a,i.delimiter,o,i.locationInfo);if(r.fields&&r.fields.length){var f,m=new Map,y=(0,n.Z)(r.fields);try{for(y.s();!(f=y.n()).done;){var v=f.value;m.set(v.name.toLowerCase(),v)}}catch(E){y.e(E)}finally{y.f()}var g,x=(0,n.Z)(d);try{for(x.s();!(g=x.n()).done;){var w=g.value,b=m.get(w.name.toLowerCase());if(b){var F=w.name;Object.assign(w,b),w.name=F}}}catch(E){x.e(E)}finally{x.f()}}if(l.fields=d,!l.fields.some((function(e){return"esriFieldTypeOID"===e.type&&(l.objectIdField=e.name,!0)}))){var k={name:"__OBJECTID",alias:"__OBJECTID",type:"esriFieldTypeOID",editable:!1,nullable:!1};l.objectIdField=k.name,l.fields.unshift(k)}if(l.timeInfo){var _=new P.Z(l.fields),I=l.timeInfo;if(I.startTimeField){var N=_.get(I.startTimeField);N?(I.startTimeField=N.name,N.type="esriFieldTypeDate"):I.startTimeField=null}if(I.endTimeField){var Z=_.get(I.endTimeField);Z?(I.endTimeField=Z.name,Z.type="esriFieldTypeDate"):I.endTimeField=null}if(I.trackIdField){var T=_.get(I.trackIdField);I.trackIdField=T?T.name:null}I.startTimeField||I.endTimeField||(l.timeInfo=null)}return i}var W=["lat","latitude","latitude83","latdecdeg","lat_dd","y","ycenter","point-y"],$=["lon","lng","long","longitude","longitude83","longdecdeg","long_dd","x","xcenter","point-x"];function Y(e){var t=e.map((function(e){return e.toLowerCase()}));return{longitudeFieldName:e[t.indexOf($.find((function(e){return t.includes(e)})))],latitudeFieldName:e[t.indexOf(W.find((function(e){return t.includes(e)})))]}}function J(e,t,r,i){var a,u=[],s=D(e,r,t),o=[],l=(0,n.Z)(s);try{for(l.s();!(a=l.n()).done;){var c=a.value;if(10===o.length)break;o.push(c)}}catch(h){l.e(h)}finally{l.f()}var p,d=(0,n.Z)(r);try{var f=function(){var e=p.value;if(e===i.longitudeFieldName||e===i.latitudeFieldName)u.push({name:e,type:"esriFieldTypeDouble",alias:e});else{var t=z(o.map((function(t){return t[e]}))),r={name:e,type:null,alias:e};switch(t){case"integer":r.type="esriFieldTypeInteger";break;case"double":r.type="esriFieldTypeDouble";break;case"date":r.type="esriFieldTypeDate",r.length=36;break;default:r.type="esriFieldTypeString",r.length=255}u.push(r)}};for(d.s();!(p=d.n()).done;)f()}catch(h){d.e(h)}finally{d.f()}return u}function z(e){if(!e.length)return"string";var t=/[^+-.,0-9]/;return e.map((function(e){var r=!1;if(""!==e){if(t.test(e))r=!0;else{var n=ee(e);if(!isNaN(n))return/[.,]/.test(e)||!Number.isInteger(n)||n>214783647||n<-214783648?"double":"integer";if(-1===e.indexOf("E"))r=!0;else{if(n=Number(e),!isNaN(n))return"double";if(-1===e.indexOf(","))r=!0;else{if(e=e.replace(",","."),n=Number(e),!isNaN(n))return"double";r=!0}}}return r?/^[-]?\d*[.,]?\d*$/.test(e)?"string":X(new Date(e),e)?"date":"string":"string"}})).reduce((function(e,t){return void 0===e||e===t?t:"string"===e||"string"===t?"string":"double"===e||"double"===t?"double":void 0}))}var H=/^((jan(uary)?)|(feb(ruary)?)|(mar(ch)?)|(apr(il)?)|(may)|(jun(e)?)|(jul(y)?)|(aug(ust)?)|(sep(tember)?)|(oct(ober)?)|(nov(ember)?)|(dec(ember)?)|(am)|(pm)|(gmt)|(utc))$/i,K=Number.isNaN(new Date("technology 10").getTime());function X(e,t){if(!e||"[object Date]"!==Object.prototype.toString.call(e)||isNaN(e.getTime()))return!1;var r=!0;if(!K&&/\d+\W*$/.test(t)){var n=t.match(/[a-zA-Z]{2,}/);if(n){for(var i=!1,a=0;!i&&a<=n.length;)i=!H.test(n[a]),a++;r=!i}}return r}var ee=function(){var e=(0,d.lt)(),t=new RegExp("^"+e.regexp+"$"),r=new RegExp("["+e.group+"\\s\\xa0]","g"),n=e.factor;return function(i){var a=t.exec(i);if(e.factor=n,!a)return NaN;var u=a[1];if(!a[1]){if(!a[2])return NaN;u=a[2],e.factor*=-1}return u=u.replace(r,"").replace(e.decimal,"."),+u*e.factor}}()},94288:function(e,t,r){r.d(t,{Dm:function(){return c},Hq:function(){return p},MS:function(){return d},bU:function(){return l}});var n=r(23796),i=r(4367),a=(r(92222),r(26699),r(32023),r(38862),r(35425)),u=r(40199),s=r(24305),o=r(12190);function l(e){return{renderer:{type:"simple",symbol:"esriGeometryPoint"===e||"esriGeometryMultipoint"===e?o.I4:"esriGeometryPolyline"===e?o.ET:o.lF}}}function c(e,t){if((0,a.Z)("esri-csp-restrictions"))return function(){return(0,i.Z)((0,n.Z)({},t,null),e)};try{var r="this.".concat(t," = null;");for(var u in e)r+="this".concat(u.includes(".")?'["'.concat(u,'"]'):".".concat(u)," = ").concat(JSON.stringify(e[u]),";");var s=new Function(r);return function(){return new s}}catch(o){return function(){return(0,i.Z)((0,n.Z)({},t,null),e)}}}function p(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return[{name:"New Feature",description:"",prototype:{attributes:(0,u.d9)(e)}}]}function d(e,t){return{attachment:null,data:{isVersioned:!1,supportsAttachment:!1,supportsM:!1,supportsZ:e},metadata:{supportsAdvancedFieldProperties:!1},operations:{supportsCalculate:!1,supportsTruncate:!1,supportsValidateSql:!1,supportsAdd:t,supportsDelete:t,supportsEditing:t,supportsChangeTracking:!1,supportsQuery:!0,supportsQueryAttachments:!1,supportsResizeAttachments:!1,supportsSync:!1,supportsUpdate:t,supportsExceedsLimitStatistics:!0},query:s.g,queryRelated:{supportsCount:!0,supportsOrderBy:!0,supportsPagination:!0},editing:{supportsGeometryUpdate:t,supportsGlobalId:!1,supportsReturnServiceEditsInSourceSpatialReference:!1,supportsRollbackOnFailure:!1,supportsUpdateWithoutM:!1,supportsUploadWithItemId:!1,supportsDeleteByAnonymous:!1,supportsDeleteByOthers:!1,supportsUpdateByAnonymous:!1,supportsUpdateByOthers:!1}}}}}]);