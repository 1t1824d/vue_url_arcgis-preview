"use strict";(self["webpackChunkvue_url_arcgis"]=self["webpackChunkvue_url_arcgis"]||[]).push([[5113],{13596:function(e,t,r){r.d(t,{m:function(){return a}});r(43371);function n(e,t,r){for(var n=e.typedBuffer,a=e.typedBufferStride,u=t.typedBuffer,o=t.typedBufferStride,i=r?r.count:t.count,s=(r&&r.dstIndex?r.dstIndex:0)*a,c=(r&&r.srcIndex?r.srcIndex:0)*o,f=0;f<i;++f)n[s]=u[c],s+=a,c+=o}function a(e,t){var r=e.count;t||(t=new e.TypedArrayConstructor(r));for(var n=0;n<r;n++)t[n]=e.get(n);return t}Object.freeze({__proto__:null,copy:n,makeDense:a})},81032:function(e,t,r){r.d(t,{f:function(){return o},n:function(){return u}});r(43371);var n=r(43206);function a(e,t,r){for(var n=e.typedBuffer,a=e.typedBufferStride,u=t.typedBuffer,o=t.typedBufferStride,i=r?r.count:t.count,s=(r&&r.dstIndex?r.dstIndex:0)*a,c=(r&&r.srcIndex?r.srcIndex:0)*o,f=0;f<i;++f)n[s]=u[c],n[s+1]=u[c+1],s+=a,c+=o}function u(e,t,r){var u=e.typedBuffer,o=e.typedBufferStride,i=t.typedBuffer,s=t.typedBufferStride,c=r?r.count:t.count,f=(r&&r.dstIndex?r.dstIndex:0)*o,l=(r&&r.srcIndex?r.srcIndex:0)*s;if((0,n.U)(t.elementType)){var p=(0,n.Op)(t.elementType);if((0,n.B3)(t.elementType))for(var d=0;d<c;++d)u[f]=Math.max(i[l]/p,-1),u[f+1]=Math.max(i[l+1]/p,-1),f+=o,l+=s;else for(var h=0;h<c;++h)u[f]=i[l]/p,u[f+1]=i[l+1]/p,f+=o,l+=s}else a(e,t,r);return e}function o(e,t,r,n){for(var a,u,o=e.typedBuffer,i=e.typedBufferStride,s=null!=(a=null==n?void 0:n.count)?a:e.count,c=(null!=(u=null==n?void 0:n.dstIndex)?u:0)*i,f=0;f<s;++f)o[c]=t,o[c+1]=r,c+=i}Object.freeze({__proto__:null,copy:a,normalizeIntegerBuffer:u,fill:o})},90314:function(e,t,r){r.d(t,{a:function(){return i},s:function(){return o},t:function(){return u}});r(43371);var n=r(33249);function a(e,t,r){if(e.count===t.count)for(var a=e.count,u=r[0],o=r[1],i=r[2],s=r[3],c=r[4],f=r[5],l=r[6],p=r[7],d=r[8],h=r[9],m=r[10],v=r[11],y=r[12],x=r[13],b=r[14],w=r[15],g=e.typedBuffer,k=e.typedBufferStride,T=t.typedBuffer,_=t.typedBufferStride,R=0;R<a;R++){var S=R*k,I=R*_,O=T[I],C=T[I+1],B=T[I+2],U=T[I+3];g[S]=u*O+c*C+d*B+y*U,g[S+1]=o*O+f*C+h*B+x*U,g[S+2]=i*O+l*C+m*B+b*U,g[S+3]=s*O+p*C+v*B+w*U}else n.k.error("source and destination buffers need to have the same number of elements")}function u(e,t,r){if(e.count===t.count)for(var a=e.count,u=r[0],o=r[1],i=r[2],s=r[3],c=r[4],f=r[5],l=r[6],p=r[7],d=r[8],h=e.typedBuffer,m=e.typedBufferStride,v=t.typedBuffer,y=t.typedBufferStride,x=0;x<a;x++){var b=x*m,w=x*y,g=v[w],k=v[w+1],T=v[w+2],_=v[w+3];h[b]=u*g+s*k+l*T,h[b+1]=o*g+c*k+p*T,h[b+2]=i*g+f*k+d*T,h[b+3]=_}else n.k.error("source and destination buffers need to have the same number of elements")}function o(e,t,r){for(var n=Math.min(e.count,t.count),a=e.typedBuffer,u=e.typedBufferStride,o=t.typedBuffer,i=t.typedBufferStride,s=0;s<n;s++){var c=s*u,f=s*i;a[c]=r*o[f],a[c+1]=r*o[f+1],a[c+2]=r*o[f+2],a[c+3]=r*o[f+3]}}function i(e,t,r){for(var n=Math.min(e.count,t.count),a=e.typedBuffer,u=e.typedBufferStride,o=t.typedBuffer,i=t.typedBufferStride,s=0;s<n;s++){var c=s*u,f=s*i;a[c]=o[f]>>r,a[c+1]=o[f+1]>>r,a[c+2]=o[f+2]>>r,a[c+3]=o[f+3]>>r}}Object.freeze({__proto__:null,transformMat4:a,transformMat3:u,scale:o,shiftRight:i})},58691:function(e,t,r){r.d(t,{c:function(){return n},f:function(){return a}});r(43371);function n(e,t,r){for(var n=e.typedBuffer,a=e.typedBufferStride,u=t.typedBuffer,o=t.typedBufferStride,i=r?r.count:t.count,s=(r&&r.dstIndex?r.dstIndex:0)*a,c=(r&&r.srcIndex?r.srcIndex:0)*o,f=0;f<i;++f)n[s]=u[c],n[s+1]=u[c+1],n[s+2]=u[c+2],n[s+3]=u[c+3],s+=a,c+=o}function a(e,t,r,n,a,u){for(var o,i,s=e.typedBuffer,c=e.typedBufferStride,f=null!=(o=null==u?void 0:u.count)?o:e.count,l=(null!=(i=null==u?void 0:u.dstIndex)?i:0)*c,p=0;p<f;++p)s[l]=t,s[l+1]=r,s[l+2]=n,s[l+3]=a,l+=c}Object.freeze({__proto__:null,copy:n,fill:a})},56144:function(e,t,r){r.d(t,{a:function(){return i},c:function(){return n},f:function(){return u}});r(41539),r(76495),r(48675),r(92990),r(18927),r(33105),r(35035),r(74345),r(7174),r(32846),r(44731),r(77209),r(96319),r(58867),r(37789),r(33739),r(29368),r(14483),r(12056),r(3462),r(30678),r(27462),r(33824),r(55021),r(12974),r(15016),r(43371);function n(){return[0,0,0,0]}function a(e){return[e[0],e[1],e[2],e[3]]}function u(e,t,r,n){return[e,t,r,n]}function o(e){for(var t=n(),r=Math.min(4,e.length),a=0;a<r;++a)t[a]=e[a];return t}function i(e,t){return new Float64Array(e,t,4)}function s(){return n()}function c(){return u(1,1,1,1)}function f(){return u(1,0,0,0)}function l(){return u(0,1,0,0)}function p(){return u(0,0,1,0)}function d(){return u(0,0,0,1)}var h=s(),m=c(),v=f(),y=l(),x=p(),b=d();Object.freeze({__proto__:null,create:n,clone:a,fromValues:u,fromArray:o,createView:i,zeros:s,ones:c,unitX:f,unitY:l,unitZ:p,unitW:d,ZEROS:h,ONES:m,UNIT_X:v,UNIT_Y:y,UNIT_Z:x,UNIT_W:b})},52111:function(e,t,r){r.d(t,{x:function(){return o}});var n=r(76133),a=r(92751),u=r(6451),o=function(){function e(t){(0,n.Z)(this,e),this.allocator=t,this._items=[],this._itemsPtr=0,this.grow()}return(0,a.Z)(e,[{key:"get",value:function(){var e=this;return 0===this._itemsPtr&&(0,u.Y)((function(){return e.reset()})),this._itemsPtr===this._items.length&&this.grow(),this._items[this._itemsPtr++]}},{key:"reset",value:function(){var e=Math.min(3*Math.max(8,this._itemsPtr),this._itemsPtr+3*i);this._items.length=Math.min(e,this._items.length),this._itemsPtr=0}},{key:"grow",value:function(){for(var e=0;e<Math.max(8,Math.min(this._items.length,i));e++)this._items.push(this.allocator())}}]),e}(),i=1024},15685:function(e,t,r){r.d(t,{G:function(){return i}});var n=r(2394),a=r(76133),u=r(92751),o=(r(92222),r(74916),r(23123),r(4723),r(25585)),i=function(){function e(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";(0,a.Z)(this,e),this.major=t,this.minor=r,this._context=n}return(0,u.Z)(e,[{key:"lessThan",value:function(e,t){return this.major<e||e===this.major&&this.minor<t}},{key:"since",value:function(e,t){return!this.lessThan(e,t)}},{key:"validate",value:function(e){if(this.major!==e.major){var t=this._context&&this._context+":",r=this._context&&this._context+" ";throw new o.Z(t+"unsupported-version","Required major ".concat(r,"version is '").concat(this.major,"', but got '${version.major}.${version.minor}'"),{version:e})}}},{key:"clone",value:function(){return new e(this.major,this.minor,this._context)}}],[{key:"parse",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a=t.split("."),u=(0,n.Z)(a,2),i=u[0],s=u[1],c=/^\s*\d+\s*$/;if(!i||!i.match||!i.match(c))throw new o.Z((r&&r+":")+"invalid-version","Expected major version to be a number, but got '${version}'",{version:t});if(!s||!s.match||!s.match(c))throw new o.Z((r&&r+":")+"invalid-version","Expected minor version to be a number, but got '${version}'",{version:t});var f=parseInt(i,10),l=parseInt(s,10);return new e(f,l,r)}}]),e}()},43206:function(e,t,r){r.d(t,{B3:function(){return a},Op:function(){return o},U:function(){return u},n1:function(){return n}});r(35425);function n(e){switch(e){case"u8":case"i8":return 1;case"u16":case"i16":return 2;case"u32":case"i32":case"f32":return 4;case"f64":return 8;default:return}}function a(e){switch(e){case"u8":case"u16":case"u32":return!1;case"i8":case"i16":case"i32":case"f32":case"f64":return!0;default:return}}function u(e){switch(e){case"u8":case"u16":case"u32":case"i8":case"i16":case"i32":return!0;case"f32":case"f64":return!1;default:return}}function o(e){switch(e){case"u8":return 255;case"u16":return 65535;case"u32":return 4294967295;case"i8":return 127;case"i16":return 32767;case"i32":return 2147483647;case"f32":return 3402823e32;case"f64":return 179769e303;default:return}}},40748:function(e,t,r){r.d(t,{gS:function(){return o}});r(18264),r(41539);var n=r(43206);r(43371);function a(e,t,r){for(var n=e.typedBuffer,a=e.typedBufferStride,u=t.typedBuffer,o=t.typedBufferStride,i=r?r.count:t.count,s=(r&&r.dstIndex?r.dstIndex:0)*a,c=(r&&r.srcIndex?r.srcIndex:0)*o,f=0;f<i;++f){for(var l=0;l<9;++l)n[s+l]=u[c+l];s+=a,c+=o}}Object.freeze({__proto__:null,copy:a});function u(e,t,r){for(var n=e.typedBuffer,a=e.typedBufferStride,u=t.typedBuffer,o=t.typedBufferStride,i=r?r.count:t.count,s=(r&&r.dstIndex?r.dstIndex:0)*a,c=(r&&r.srcIndex?r.srcIndex:0)*o,f=0;f<i;++f){for(var l=0;l<16;++l)n[s+l]=u[c+l];s+=a,c+=o}}Object.freeze({__proto__:null,copy:u}),r(13596),r(81032),r(45267),r(58691);function o(e,t){return new e(new ArrayBuffer(t*e.ElementCount*(0,n.n1)(e.ElementType)))}},79039:function(e,t,r){r.d(t,{MP:function(){return m},WM:function(){return h}});var n=r(76133),a=r(92751),u=(r(18264),r(41539),r(6451)),o=r(88250),i=r(44858),s=r(45443),c=r(36122),f=r(42325),l=r(56144),p=function(){function e(t,r,a){(0,n.Z)(this,e),this.itemByteSize=t,this.itemCreate=r,this._buffers=new Array,this._items=new Array,this._itemsPtr=0,this._itemsPerBuffer=Math.ceil(a/this.itemByteSize)}return(0,a.Z)(e,[{key:"get",value:function(){var e=this;0===this._itemsPtr&&(0,u.Y)((function(){return e.reset()}));for(var t=Math.floor(this._itemsPtr/this._itemsPerBuffer);this._buffers.length<=t;){for(var r=new ArrayBuffer(this._itemsPerBuffer*this.itemByteSize),n=0;n<this._itemsPerBuffer;++n)this._items.push(this.itemCreate(r,n*this.itemByteSize));this._buffers.push(r)}return this._items[this._itemsPtr++]}},{key:"reset",value:function(){for(var e=2*(Math.floor(this._itemsPtr/this._itemsPerBuffer)+1);this._buffers.length>e;)this._buffers.pop(),this._items.length=this._buffers.length*this._itemsPerBuffer;this._itemsPtr=0}},{key:"test",get:function(){return{size:this._buffers.length*this._itemsPerBuffer*this.itemByteSize}}}],[{key:"createVec2f64",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d;return new e(16,c.c,t)}},{key:"createVec3f64",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d;return new e(24,f.b,t)}},{key:"createVec4f64",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d;return new e(32,l.a,t)}},{key:"createMat3f64",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d;return new e(72,o.a,t)}},{key:"createMat4f64",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d;return new e(128,i.a,t)}},{key:"createQuatf64",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d;return new e(32,s.c,t)}}]),e}(),d=4096,h=(p.createVec2f64(),p.createVec3f64()),m=(p.createVec4f64(),p.createMat3f64(),p.createMat4f64());p.createQuatf64()},83394:function(e,t,r){r.d(t,{C:function(){return p}});var n=r(16198),a=r(76133),u=r(92751),o=(r(78975),r(35680)),i=r(53855),s=r(25585),c=r(27092),f=r(24446),l=r(58476),p=function(){function e(t){(0,a.Z)(this,e),this.streamDataRequester=t}return(0,u.Z)(e,[{key:"loadJSON",value:function(){var e=(0,n.Z)(regeneratorRuntime.mark((function e(t,r){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",this.load("json",t,r));case 1:case"end":return e.stop()}}),e,this)})));function t(t,r){return e.apply(this,arguments)}return t}()},{key:"loadBinary",value:function(){var e=(0,n.Z)(regeneratorRuntime.mark((function e(t,r){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.HK)(t)?((0,f.k_)(r),(0,l.AH)(t)):this.load("binary",t,r));case 1:case"end":return e.stop()}}),e,this)})));function t(t,r){return e.apply(this,arguments)}return t}()},{key:"loadImage",value:function(){var e=(0,n.Z)(regeneratorRuntime.mark((function e(t,r){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",this.load("image",t,r));case 1:case"end":return e.stop()}}),e,this)})));function t(t,r){return e.apply(this,arguments)}return t}()},{key:"load",value:function(){var e=(0,n.Z)(regeneratorRuntime.mark((function e(t,r,n){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!(0,c.Wi)(this.streamDataRequester)){e.next=4;break}return e.next=3,(0,o["default"])(r,{responseType:d[t]});case 3:return e.abrupt("return",e.sent.data);case 4:return e.next=6,(0,i.q6)(this.streamDataRequester.request(r,t,n));case 6:if(a=e.sent,!0!==a.ok){e.next=9;break}return e.abrupt("return",a.value);case 9:throw(0,f.r9)(a.error),new s.Z("","Request for resource failed: ".concat(a.error));case 10:case"end":return e.stop()}}),e,this)})));function t(t,r,n){return e.apply(this,arguments)}return t}()}]),e}(),d={image:"image",binary:"array-buffer",json:"json"}},86114:function(e,t,r){r.d(t,{DA:function(){return o},jX:function(){return i},nh:function(){return u}});r(41539),r(29135),r(48675),r(92990),r(18927),r(33105),r(35035),r(74345),r(7174),r(32846),r(44731),r(77209),r(96319),r(58867),r(37789),r(33739),r(29368),r(14483),r(12056),r(3462),r(30678),r(27462),r(33824),r(55021),r(12974),r(15016),r(8255);var n=r(17914),a=r(52421);function u(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a.p;return"number"==typeof e?t(e):(0,n.Uc)(e)||(0,n.lq)(e)?new Uint32Array(e):e}function o(e){var t="number"==typeof e?e:e.length;if(t<3)return new Uint16Array(0);var r=t-2,n=r<=65536?new Uint16Array(3*r):new Uint32Array(3*r);if("number"==typeof e)for(var a=0,u=0;u<r;u+=1)u%2==0?(n[a++]=u,n[a++]=u+1,n[a++]=u+2):(n[a++]=u+1,n[a++]=u,n[a++]=u+2);else for(var o=0,i=0;i<r;i+=1)if(i%2==0){var s=e[i],c=e[i+1],f=e[i+2];n[o++]=s,n[o++]=c,n[o++]=f}else{var l=e[i+1],p=e[i],d=e[i+2];n[o++]=l,n[o++]=p,n[o++]=d}return n}function i(e){var t="number"==typeof e?e:e.length;if(t<3)return new Uint16Array(0);var r=t-2,n=r<=65536?new Uint16Array(3*r):new Uint32Array(3*r);if("number"==typeof e){for(var a=0,u=0;u<r;++u)n[a++]=0,n[a++]=u+1,n[a++]=u+2;return n}for(var o=e[0],i=e[1],s=0,c=0;c<r;++c){var f=e[c+2];n[s++]=o,n[s++]=i,n[s++]=f,i=f}return n}},64798:function(e,t,r){r.d(t,{z:function(){return X}});var n=r(62032),a=r(16198),u=(r(78975),r(41539),r(54747),r(92222),r(68309),r(51532),r(78783),r(33948),r(57327),r(27092)),o=r(44858),i=r(76133),s=r(92751),c=r(25585),f=r(87441),l=f.Z.getLogger("esri.views.3d.glTF"),p=function(){function e(){(0,i.Z)(this,e)}return(0,s.Z)(e,[{key:"error",value:function(e){throw new c.Z("gltf-loader-error",e)}},{key:"errorUnsupported",value:function(e){throw new c.Z("gltf-loader-unsupported-feature",e)}},{key:"errorUnsupportedIf",value:function(e,t){e&&this.errorUnsupported(t)}},{key:"assert",value:function(e,t){e||this.error(t)}},{key:"warn",value:function(e){l.warn(e)}},{key:"warnUnsupported",value:function(e){this.warn("[Unsupported Feature] "+e)}},{key:"warnUnsupportedIf",value:function(e,t){e&&this.warnUnsupported(t)}}]),e}(),d=r(4367);function h(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,d.Z)({color:[1,1,1],opacity:1,alphaMode:"OPAQUE",alphaCutoff:.5,doubleSided:!1,castShadows:!0,receiveShadows:!0,receiveAmbientOcclustion:!0,textureColor:null,textureNormal:null,textureOcclusion:null,textureEmissive:null,textureMetallicRoughness:null,emissiveFactor:[0,0,0],metallicFactor:1,roughnessFactor:1,colorMixMode:"multiply"},e)}function m(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return{data:e,parameters:(0,d.Z)({wrap:(0,d.Z)({s:10497,t:10497},t.wrap),noUnpackFlip:!0,mipmap:!1},t)}}r(82472),r(48675),r(92990),r(18927),r(33105),r(35035),r(74345),r(7174),r(32846),r(44731),r(77209),r(96319),r(58867),r(37789),r(33739),r(29368),r(14483),r(12056),r(3462),r(30678),r(27462),r(33824),r(55021),r(12974),r(15016),r(8255),r(29135),r(56977),r(69600),r(75505),r(87714),r(82801),r(1174),r(27852),r(60285),r(41637);var v=r(21677),y=r(43713),x=r(58476),b=r(15685),w=r(11197),g=r(95046),k=r(45443),T=r(16886),_=r(13596),R=function(){function e(t){(0,i.Z)(this,e),this.data=t,this.offset4=0,this.dataUint32=new Uint32Array(this.data,0,Math.floor(this.data.byteLength/4))}return(0,s.Z)(e,[{key:"readUint32",value:function(){var e=this.offset4;return this.offset4+=1,this.dataUint32[e]}},{key:"readUint8Array",value:function(e){var t=4*this.offset4;return this.offset4+=e/4,new Uint8Array(this.data,t,e)}},{key:"remainingBytes",value:function(){return this.data.byteLength-4*this.offset4}}]),e}(),S={baseColorFactor:[1,1,1,1],metallicFactor:1,roughnessFactor:1},I={pbrMetallicRoughness:S,emissiveFactor:[0,0,0],alphaMode:"OPAQUE",alphaCutoff:.5,doubleSided:!1},O={ESRI_externalColorMixMode:"tint"},C=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,d.Z)((0,d.Z)({},S),e.pbrMetallicRoughness),r=B((0,d.Z)((0,d.Z)({},O),e.extras));return(0,d.Z)((0,d.Z)((0,d.Z)({},I),e),{},{pbrMetallicRoughness:t,extras:r})};function B(e){switch(e.ESRI_externalColorMixMode){case"multiply":case"tint":case"ignore":case"replace":break;default:(0,v.Bg)(e.ESRI_externalColorMixMode),e.ESRI_externalColorMixMode="tint"}return e}var U={magFilter:9729,minFilter:9987,wrapS:10497,wrapT:10497},A=function(e){return(0,d.Z)((0,d.Z)({},U),e)};r(74916),r(15306);function M(e){var t,r;return e.replace(/^(.*\/)?([^/]*)$/,(function(e,n,a){return t=n||"",r=a||"",""})),{dirPart:t,filePart:r}}var N={MAGIC:1179937895,CHUNK_TYPE_JSON:1313821514,CHUNK_TYPE_BIN:5130562,MIN_HEADER_LENGTH:20},E=function(){function e(t,r,n,a,u){(0,i.Z)(this,e),this.context=t,this.errorContext=r,this.uri=n,this.json=a,this.glbBuffer=u,this.bufferLoaders=new Map,this.textureLoaders=new Map,this.textureCache=new Map,this.materialCache=new Map,this.nodeParentMap=new Map,this.nodeTransformCache=new Map,this.baseUri=M(this.uri).dirPart,this.checkVersionSupported(),this.checkRequiredExtensionsSupported(),r.errorUnsupportedIf(null==a.scenes,"Scenes must be defined."),r.errorUnsupportedIf(null==a.meshes,"Meshes must be defined"),r.errorUnsupportedIf(null==a.nodes,"Nodes must be defined."),this.computeNodeParents()}return(0,s.Z)(e,[{key:"getBuffer",value:function(){var e=(0,a.Z)(regeneratorRuntime.mark((function e(t,r){var n,a,u;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=this.json.buffers[t],a=this.errorContext,null!=n.uri){e.next=3;break}return e.abrupt("return",(a.assert(null!=this.glbBuffer,"GLB buffer not present"),this.glbBuffer));case 3:return e.next=5,this.getBufferLoader(t,r);case 5:return u=e.sent,e.abrupt("return",(a.assert(u.byteLength===n.byteLength,"Buffer byte lengths should match."),u));case 7:case"end":return e.stop()}}),e,this)})));function t(t,r){return e.apply(this,arguments)}return t}()},{key:"getBufferLoader",value:function(){var e=(0,a.Z)(regeneratorRuntime.mark((function e(t,r){var n,a,u;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=this.bufferLoaders.get(t),!n){e.next=3;break}return e.abrupt("return",n);case 3:return a=this.json.buffers[t],u=this.context.loadBinary(this.resolveUri(a.uri),r).then((function(e){return new Uint8Array(e)})),e.abrupt("return",(this.bufferLoaders.set(t,u),u));case 5:case"end":return e.stop()}}),e,this)})));function t(t,r){return e.apply(this,arguments)}return t}()},{key:"getAccessor",value:function(){var e=(0,a.Z)(regeneratorRuntime.mark((function e(t,r){var n,a,u,o,i,s,c,f;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=this.errorContext,n.errorUnsupportedIf(!this.json.accessors,"Accessors missing."),a=this.json.accessors[t],n.errorUnsupportedIf(null==(null==a?void 0:a.bufferView),"Some accessor does not specify a bufferView."),n.errorUnsupportedIf(a.type in["MAT2","MAT3","MAT4"],"AttributeType ".concat(a.type," is not supported")),u=this.json.bufferViews[a.bufferView],e.next=7,this.getBuffer(u.buffer,r);case 7:return o=e.sent,i=F[a.type],s=j[a.componentType],c=i*s,f=u.byteStride||c,e.abrupt("return",{raw:o.buffer,byteStride:f,byteOffset:o.byteOffset+(u.byteOffset||0)+(a.byteOffset||0),entryCount:a.count,isDenselyPacked:f===c,componentCount:i,componentByteSize:s,componentType:a.componentType,min:a.min,max:a.max,normalized:!!a.normalized});case 13:case"end":return e.stop()}}),e,this)})));function t(t,r){return e.apply(this,arguments)}return t}()},{key:"getIndexData",value:function(){var e=(0,a.Z)(regeneratorRuntime.mark((function e(t,r){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(null!=t.indices){e.next=2;break}return e.abrupt("return",null);case 2:return e.next=4,this.getAccessor(t.indices,r);case 4:if(n=e.sent,!n.isDenselyPacked){e.next=14;break}e.t0=n.componentType,e.next=5121===e.t0?9:5123===e.t0?10:5125===e.t0?11:12;break;case 9:return e.abrupt("return",new Uint8Array(n.raw,n.byteOffset,n.entryCount));case 10:return e.abrupt("return",new Uint16Array(n.raw,n.byteOffset,n.entryCount));case 11:return e.abrupt("return",new Uint32Array(n.raw,n.byteOffset,n.entryCount));case 12:e.next=20;break;case 14:e.t1=n.componentType,e.next=5121===e.t1?17:5123===e.t1?18:5125===e.t1?19:20;break;case 17:return e.abrupt("return",(0,_.m)(this.wrapAccessor(T.D_,n)));case 18:return e.abrupt("return",(0,_.m)(this.wrapAccessor(T.av,n)));case 19:return e.abrupt("return",(0,_.m)(this.wrapAccessor(T.Nu,n)));case 20:case"end":return e.stop()}}),e,this)})));function t(t,r){return e.apply(this,arguments)}return t}()},{key:"getPositionData",value:function(){var e=(0,a.Z)(regeneratorRuntime.mark((function e(t,r){var n,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=this.errorContext,n.errorUnsupportedIf(null==t.attributes.POSITION,"No POSITION vertex data found."),e.next=4,this.getAccessor(t.attributes.POSITION,r);case 4:return a=e.sent,e.abrupt("return",(n.errorUnsupportedIf(5126!==a.componentType,"Expected type FLOAT for POSITION vertex attribute, but found "+H[a.componentType]),n.errorUnsupportedIf(3!==a.componentCount,"POSITION vertex attribute must have 3 components, but found "+a.componentCount.toFixed()),this.wrapAccessor(T.ct,a)));case 6:case"end":return e.stop()}}),e,this)})));function t(t,r){return e.apply(this,arguments)}return t}()},{key:"getNormalData",value:function(){var e=(0,a.Z)(regeneratorRuntime.mark((function e(t,r){var n,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=this.errorContext,n.assert(null!=t.attributes.NORMAL,"No NORMAL vertex data found."),e.next=4,this.getAccessor(t.attributes.NORMAL,r);case 4:return a=e.sent,e.abrupt("return",(n.errorUnsupportedIf(5126!==a.componentType,"Expected type FLOAT for NORMAL vertex attribute, but found "+H[a.componentType]),n.errorUnsupportedIf(3!==a.componentCount,"NORMAL vertex attribute must have 3 components, but found "+a.componentCount.toFixed()),this.wrapAccessor(T.ct,a)));case 6:case"end":return e.stop()}}),e,this)})));function t(t,r){return e.apply(this,arguments)}return t}()},{key:"getTangentData",value:function(){var e=(0,a.Z)(regeneratorRuntime.mark((function e(t,r){var n,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=this.errorContext,n.assert(null!=t.attributes.TANGENT,"No TANGENT vertex data found."),e.next=4,this.getAccessor(t.attributes.TANGENT,r);case 4:return a=e.sent,e.abrupt("return",(n.errorUnsupportedIf(5126!==a.componentType,"Expected type FLOAT for TANGENT vertex attribute, but found "+H[a.componentType]),n.errorUnsupportedIf(4!==a.componentCount,"TANGENT vertex attribute must have 4 components, but found "+a.componentCount.toFixed()),new T.ek(a.raw,a.byteOffset,a.byteStride,a.byteOffset+a.byteStride*a.entryCount)));case 6:case"end":return e.stop()}}),e,this)})));function t(t,r){return e.apply(this,arguments)}return t}()},{key:"getTextureCoordinates",value:function(){var e=(0,a.Z)(regeneratorRuntime.mark((function e(t,r){var n,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=this.errorContext,n.assert(null!=t.attributes.TEXCOORD_0,"No TEXCOORD_0 vertex data found."),e.next=4,this.getAccessor(t.attributes.TEXCOORD_0,r);case 4:return a=e.sent,e.abrupt("return",(n.errorUnsupportedIf(2!==a.componentCount,"TEXCOORD_0 vertex attribute must have 2 components, but found "+a.componentCount.toFixed()),5126===a.componentType?this.wrapAccessor(T.Eu,a):(n.errorUnsupportedIf(!a.normalized,"Integer component types are only supported for a normalized accessor for TEXCOORD_0."),D(a))));case 6:case"end":return e.stop()}}),e,this)})));function t(t,r){return e.apply(this,arguments)}return t}()},{key:"getVertexColors",value:function(){var e=(0,a.Z)(regeneratorRuntime.mark((function e(t,r){var n,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=this.errorContext,n.assert(null!=t.attributes.COLOR_0,"No COLOR_0 vertex data found."),e.next=4,this.getAccessor(t.attributes.COLOR_0,r);case 4:if(a=e.sent,n.errorUnsupportedIf(4!==a.componentCount&&3!==a.componentCount,"COLOR_0 attribute must have 3 or 4 components, but found "+a.componentCount.toFixed()),4!==a.componentCount){e.next=14;break}if(5126!==a.componentType){e.next=8;break}return e.abrupt("return",this.wrapAccessor(T.ek,a));case 8:if(5121!==a.componentType){e.next=10;break}return e.abrupt("return",this.wrapAccessor(T.mc,a));case 10:if(5123!==a.componentType){e.next=12;break}return e.abrupt("return",this.wrapAccessor(T.v6,a));case 12:e.next=21;break;case 14:if(3!==a.componentCount){e.next=21;break}if(5126!==a.componentType){e.next=17;break}return e.abrupt("return",this.wrapAccessor(T.ct,a));case 17:if(5121!==a.componentType){e.next=19;break}return e.abrupt("return",this.wrapAccessor(T.ne,a));case 19:if(5123!==a.componentType){e.next=21;break}return e.abrupt("return",this.wrapAccessor(T.mw,a));case 21:n.errorUnsupported("Unsupported component type for COLOR_0 attribute: "+H[a.componentType]);case 22:case"end":return e.stop()}}),e,this)})));function t(t,r){return e.apply(this,arguments)}return t}()},{key:"hasPositions",value:function(e){return void 0!==e.attributes.POSITION}},{key:"hasNormals",value:function(e){return void 0!==e.attributes.NORMAL}},{key:"hasVertexColors",value:function(e){return void 0!==e.attributes.COLOR_0}},{key:"hasTextureCoordinates",value:function(e){return void 0!==e.attributes.TEXCOORD_0}},{key:"hasTangents",value:function(e){return void 0!==e.attributes.TANGENT}},{key:"getMaterial",value:function(){var e=(0,a.Z)(regeneratorRuntime.mark((function e(t,r,n){var a,u,o,i,s,c,f,l,p,d;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(a=this.materialCache.get(t.material),a){e.next=30;break}return u=null!=t.material?C(this.json.materials[t.material]):C(),o=u.pbrMetallicRoughness,i=this.hasVertexColors(t),s=this.getTexture(o.baseColorTexture,r),c=this.getTexture(u.normalTexture,r),f=n?this.getTexture(u.occlusionTexture,r):null,l=n?this.getTexture(u.emissiveTexture,r):null,p=n?this.getTexture(o.metallicRoughnessTexture,r):null,d=null!=t.material?t.material:-1,e.t0=u.alphaMode,e.t1=u.alphaCutoff,e.t2=o.baseColorFactor,e.t3=!!u.doubleSided,e.next=9,s;case 9:return e.t4=e.sent,e.next=12,c;case 12:return e.t5=e.sent,e.t6=u.name,e.t7=d,e.next=17,f;case 17:return e.t8=e.sent,e.next=20,l;case 20:return e.t9=e.sent,e.t10=u.emissiveFactor,e.t11=o.metallicFactor,e.t12=o.roughnessFactor,e.next=26,p;case 26:e.t13=e.sent,e.t14=i,e.t15=u.extras.ESRI_externalColorMixMode,a={alphaMode:e.t0,alphaCutoff:e.t1,color:e.t2,doubleSided:e.t3,colorTexture:e.t4,normalTexture:e.t5,name:e.t6,id:e.t7,occlusionTexture:e.t8,emissiveTexture:e.t9,emissiveFactor:e.t10,metallicFactor:e.t11,roughnessFactor:e.t12,metallicRoughnessTexture:e.t13,vertexColors:e.t14,ESRI_externalColorMixMode:e.t15};case 30:return e.abrupt("return",a);case 31:case"end":return e.stop()}}),e,this)})));function t(t,r,n){return e.apply(this,arguments)}return t}()},{key:"getTexture",value:function(){var e=(0,a.Z)(regeneratorRuntime.mark((function e(t,r){var n,a,u,o,i,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",null);case 2:return this.errorContext.errorUnsupportedIf(0!==(t.texCoord||0),"Only TEXCOORD with index 0 is supported."),n=t.index,a=this.errorContext,u=this.json.textures[n],o=A(null!=u.sampler?this.json.samplers[u.sampler]:{}),a.errorUnsupportedIf(null==u.source,"Source is expected to be defined for a texture."),i=this.json.images[u.source],e.next=8,this.loadTextureImageData(n,u,r);case 8:return s=e.sent,e.abrupt("return",(0,y.s1)(this.textureCache,n,(function(){var e=function(e){return 33071===e||33648===e||10497===e},t=function(e){return a.error("Unexpected TextureSampler WrapMode: ".concat(e,". Using default REPEAT(10497).")),10497};return{data:s,wrapS:e(o.wrapS)?o.wrapS:t(o.wrapS),wrapT:e(o.wrapT)?o.wrapT:t(o.wrapT),minFilter:o.minFilter,name:i.name,id:n}})));case 10:case"end":return e.stop()}}),e,this)})));function t(t,r){return e.apply(this,arguments)}return t}()},{key:"getNodeTransform",value:function(e){if(void 0===e)return Z;var t=this.nodeTransformCache.get(e);if(!t){var r=this.getNodeTransform(this.getNodeParent(e)),n=this.json.nodes[e];n.matrix?t=(0,w.m)((0,o.c)(),r,n.matrix):n.translation||n.rotation||n.scale?(t=(0,o.b)(r),n.translation&&(0,w.a)(t,t,n.translation),n.rotation&&(P[3]=(0,g.g)(P,n.rotation),(0,w.e)(t,t,P[3],P)),n.scale&&(0,w.f)(t,t,n.scale)):t=r,this.nodeTransformCache.set(e,t)}return t}},{key:"wrapAccessor",value:function(e,t){return new e(t.raw,t.byteOffset,t.byteStride,t.byteOffset+t.byteStride*(t.entryCount-1)+t.componentByteSize*t.componentCount)}},{key:"resolveUri",value:function(e){return(0,x.hF)(e,this.baseUri)}},{key:"getNodeParent",value:function(e){return this.nodeParentMap.get(e)}},{key:"checkVersionSupported",value:function(){var e=b.G.parse(this.json.asset.version,"glTF");L.validate(e)}},{key:"checkRequiredExtensionsSupported",value:function(){var e=this.json,t=this.errorContext;e.extensionsRequired&&0!==e.extensionsRequired.length&&t.errorUnsupported("gltf loader was not able to load unsupported feature. Required extensions: "+e.extensionsRequired.join(", "))}},{key:"computeNodeParents",value:function(){var e=this;this.json.nodes.forEach((function(t,r){t.children&&t.children.forEach((function(t){e.nodeParentMap.set(t,r)}))}))}},{key:"loadTextureImageData",value:function(){var e=(0,a.Z)(regeneratorRuntime.mark((function e(t,r,n){var a,u;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(a=this.textureLoaders.get(t),!a){e.next=3;break}return e.abrupt("return",a);case 3:return u=this.createTextureLoader(r,n),e.abrupt("return",(this.textureLoaders.set(t,u),u));case 5:case"end":return e.stop()}}),e,this)})));function t(t,r,n){return e.apply(this,arguments)}return t}()},{key:"createTextureLoader",value:function(){var e=(0,a.Z)(regeneratorRuntime.mark((function e(t,r){var n,a,u,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=this.json.images[t.source],!n.uri){e.next=3;break}return e.abrupt("return",this.context.loadImage(this.resolveUri(n.uri),r));case 3:return a=this.errorContext,a.errorUnsupportedIf(null==n.bufferView,"Image bufferView must be defined."),a.errorUnsupportedIf(null==n.mimeType,"Image mimeType must be defined."),u=this.json.bufferViews[n.bufferView],e.next=8,this.getBuffer(u.buffer,r);case 8:return o=e.sent,e.abrupt("return",(a.errorUnsupportedIf(null!=u.byteStride,"byteStride not supported for image buffer"),z(new Uint8Array(o.buffer,o.byteOffset+(u.byteOffset||0),u.byteLength),n.mimeType)));case 10:case"end":return e.stop()}}),e,this)})));function t(t,r){return e.apply(this,arguments)}return t}()}],[{key:"load",value:function(){var t=(0,a.Z)(regeneratorRuntime.mark((function t(r,n,a,u){var o,i,s,c,f,l;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!(0,x.HK)(a)){t.next=13;break}if(o=(0,x.sJ)(a),"model/gltf-binary"===o.mediaType){t.next=10;break}return t.prev=3,i=JSON.parse(o.isBase64?atob(o.data):o.data),t.abrupt("return",new e(r,n,a,i));case 8:t.prev=8,t.t0=t["catch"](3);case 10:if(s=(0,x.AH)(a),!e.isGLBData(s)){t.next=13;break}return t.abrupt("return",this.fromGLBData(r,n,a,s));case 13:if(!a.endsWith(".gltf")){t.next=18;break}return t.next=16,r.loadJSON(a,u);case 16:return c=t.sent,t.abrupt("return",new e(r,n,a,c));case 18:return t.next=20,r.loadBinary(a,u);case 20:if(f=t.sent,!e.isGLBData(f)){t.next=23;break}return t.abrupt("return",this.fromGLBData(r,n,a,f));case 23:return t.next=25,r.loadJSON(a,u);case 25:return l=t.sent,t.abrupt("return",new e(r,n,a,l));case 27:case"end":return t.stop()}}),t,this,[[3,8]])})));function r(e,r,n,a){return t.apply(this,arguments)}return r}()},{key:"isGLBData",value:function(e){var t=new R(e);return t.remainingBytes()>=4&&t.readUint32()===N.MAGIC}},{key:"fromGLBData",value:function(){var t=(0,a.Z)(regeneratorRuntime.mark((function t(r,n,a,u){var o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.parseGLBData(n,u);case 2:return o=t.sent,t.abrupt("return",new e(r,n,a,o.json,o.binaryData));case 4:case"end":return t.stop()}}),t)})));function r(e,r,n,a){return t.apply(this,arguments)}return r}()},{key:"parseGLBData",value:function(){var e=(0,a.Z)(regeneratorRuntime.mark((function e(t,r){var n,a,u,o,i,s,c,f,l;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:n=new R(r),t.assert(n.remainingBytes()>=12,"GLB binary data is insufficiently large."),a=n.readUint32(),u=n.readUint32(),o=n.readUint32(),t.assert(a===N.MAGIC,"Magic first 4 bytes do not fit to expected GLB value."),t.assert(r.byteLength>=o,"GLB binary data is smaller than header specifies."),t.errorUnsupportedIf(2!==u,"An unsupported GLB container version was detected. Only version 2 is supported."),c=0;case 5:if(!(n.remainingBytes()>=8)){e.next=19;break}if(f=n.readUint32(),l=n.readUint32(),0!==c){e.next=15;break}return t.assert(l===N.CHUNK_TYPE_JSON,"First GLB chunk must be JSON."),t.assert(f>=0,"No JSON data found."),e.next=12,G(n.readUint8Array(f));case 12:i=e.sent,e.next=16;break;case 15:1===c?(t.errorUnsupportedIf(l!==N.CHUNK_TYPE_BIN,"Second GLB chunk expected to be BIN."),s=n.readUint8Array(f)):t.warnUnsupported("More than 2 GLB chunks detected. Skipping.");case 16:c+=1;case 17:e.next=5;break;case 19:return e.abrupt("return",(i||t.error("No GLB JSON chunk detected."),{json:i,binaryData:s}));case 20:case"end":return e.stop()}}),e)})));function t(t,r){return e.apply(this,arguments)}return t}()}]),e}(),L=new b.G(2,0,"glTF"),Z=(0,w.u)((0,o.c)(),Math.PI/2),P=(0,k.a)(),F={SCALAR:1,VEC2:2,VEC3:3,VEC4:4},j={5120:1,5121:1,5122:2,5123:2,5126:4,5125:4};function D(e){switch(e.componentType){case 5120:return new T.Vs(e.raw,e.byteOffset,e.byteStride,e.byteOffset+e.byteStride*e.entryCount);case 5121:return new T.xA(e.raw,e.byteOffset,e.byteStride,e.byteOffset+e.byteStride*e.entryCount);case 5122:return new T.or(e.raw,e.byteOffset,e.byteStride,e.byteOffset+e.byteStride*e.entryCount);case 5123:return new T.TS(e.raw,e.byteOffset,e.byteStride,e.byteOffset+e.byteStride*e.entryCount);case 5125:return new T.qt(e.raw,e.byteOffset,e.byteStride,e.byteOffset+e.byteStride*e.entryCount);case 5126:return new T.Eu(e.raw,e.byteOffset,e.byteStride,e.byteOffset+e.byteStride*e.entryCount);default:return void(0,v.Bg)(e.componentType)}}function G(e){return V.apply(this,arguments)}function V(){return V=(0,a.Z)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,r){var n=new Blob([t]),a=new FileReader;a.onload=function(){var t=a.result;e(JSON.parse(t))},a.onerror=function(e){r(e)},a.readAsText(n)})));case 1:case"end":return e.stop()}}),e)}))),V.apply(this,arguments)}function z(e,t){return q.apply(this,arguments)}function q(){return q=(0,a.Z)(regeneratorRuntime.mark((function e(t,r){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){var a=new Blob([t],{type:r}),u=URL.createObjectURL(a),o=new Image;o.addEventListener("load",(function(){URL.revokeObjectURL(u),"decode"in o?o.decode().then((function(){return e(o)}),(function(){return e(o)})):e(o)})),o.addEventListener("error",(function(e){URL.revokeObjectURL(u),n(e)})),o.src=u})));case 1:case"end":return e.stop()}}),e)}))),q.apply(this,arguments)}var H={5120:"BYTE",5121:"UNSIGNED_BYTE",5122:"SHORT",5123:"UNSIGNED_SHORT",5125:"UNSIGNED_INT",5126:"FLOAT"},J=0;function X(e,t){return Y.apply(this,arguments)}function Y(){return Y=(0,a.Z)(regeneratorRuntime.mark((function e(t,r){var i,s,c,f,l,p,d,h,m,v,y=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return i=y.length>2&&void 0!==y[2]?y[2]:{},s=!(y.length>3&&void 0!==y[3])||y[3],e.next=4,E.load(t,te,r,i);case 4:return c=e.sent,f="gltf_"+J++,l={lods:[],materials:new Map,textures:new Map,meta:K(c)},p=!(!c.json.asset.extras||"symbolResource"!==c.json.asset.extras.ESRI_type),d=new Map,e.next=11,W(c,function(){var e=(0,a.Z)(regeneratorRuntime.mark((function e(t,r,n,a){var p,h,m,v,y,x,b,w,g,k,T,_,R;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(h=null!=(p=d.get(n))?p:0,d.set(n,h+1),m=void 0!==t.mode?t.mode:4,v=4===m||5===m||6===m?m:null,!(0,u.Wi)(v)){e.next=5;break}return e.abrupt("return",void te.warnUnsupported("Unsupported primitive mode ("+ne[m]+"). Skipping primitive."));case 5:if(c.hasPositions(t)){e.next=7;break}return e.abrupt("return",void te.warn("Skipping primitive without POSITION vertex attribute."));case 7:return y=c.getPositionData(t,i),x=c.getMaterial(t,i,s),b=c.hasNormals(t)?c.getNormalData(t,i):null,w=c.hasTangents(t)?c.getTangentData(t,i):null,g=c.hasTextureCoordinates(t)?c.getTextureCoordinates(t,i):null,k=c.hasVertexColors(t)?c.getVertexColors(t,i):null,T=c.getIndexData(t,i),e.t0=(0,o.b)(r),e.next=17,y;case 17:if(e.t1=e.sent,!b){e.next=24;break}return e.next=21,b;case 21:e.t2=e.sent,e.next=25;break;case 24:e.t2=null;case 25:if(e.t3=e.t2,!g){e.next=32;break}return e.next=29,g;case 29:e.t4=e.sent,e.next=33;break;case 32:e.t4=null;case 33:if(e.t5=e.t4,!k){e.next=40;break}return e.next=37,k;case 37:e.t6=e.sent,e.next=41;break;case 40:e.t6=null;case 41:if(e.t7=e.t6,!w){e.next=48;break}return e.next=45,w;case 45:e.t8=e.sent,e.next=49;break;case 48:e.t8=null;case 49:return e.t9=e.t8,e.t10={position:e.t1,normal:e.t3,texCoord0:e.t5,color:e.t7,tangent:e.t9},e.next=53,T;case 53:return e.t11=e.sent,e.t12=v,e.t13=ee,e.t14=l,e.next=59,x;case 59:e.t15=e.sent,e.t16=f,e.t17=(0,e.t13)(e.t14,e.t15,e.t16),_={transform:e.t0,attributes:e.t10,indices:e.t11,primitiveType:e.t12,material:e.t17},R=null,(0,u.pC)(l.meta)&&(0,u.pC)(l.meta.ESRI_lod)&&"screenSpaceRadius"===l.meta.ESRI_lod.metric&&(R=l.meta.ESRI_lod.thresholds[n]),l.lods[n]=l.lods[n]||{parts:[],name:a,lodThreshold:R},l.lods[n].parts[h]=_;case 65:case"end":return e.stop()}}),e)})));return function(t,r,n,a){return e.apply(this,arguments)}}());case 11:h=(0,n.Z)(l.lods);try{for(h.s();!(m=h.n()).done;)v=m.value,v.parts=v.parts.filter((function(e){return!!e}))}catch(x){h.e(x)}finally{h.f()}return e.abrupt("return",{model:l,meta:{isEsriSymbolResource:p,uri:c.uri},customMeta:{}});case 14:case"end":return e.stop()}}),e)}))),Y.apply(this,arguments)}function K(e){var t=e.json,r=null;return t.nodes.forEach((function(e){var t=e.extras;(0,u.pC)(t)&&(t.ESRI_proxyEllipsoid||t.ESRI_lod)&&(r=t)})),r}function W(e,t){return $.apply(this,arguments)}function $(){return $=(0,a.Z)(regeneratorRuntime.mark((function e(t,r){var u,o,i,s,c,f,l,p,d,h;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:h=function(){return h=(0,a.Z)(regeneratorRuntime.mark((function e(a,o){var i,c,f,l,p,h,m,v,y;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(i=u.nodes[a],c=t.getNodeTransform(a),te.warnUnsupportedIf(null!=i.weights,"Morph targets are not supported."),null!=i.mesh){f=u.meshes[i.mesh],l=(0,n.Z)(f.primitives);try{for(l.s();!(p=l.n()).done;)h=p.value,s.push(r(h,c,o,f.name))}catch(x){l.e(x)}finally{l.f()}}m=(0,n.Z)(i.children||[]);try{for(m.s();!(v=m.n()).done;)y=v.value,s.push(d(y,o))}catch(x){m.e(x)}finally{m.f()}case 4:case"end":return e.stop()}}),e)}))),h.apply(this,arguments)},d=function(e,t){return h.apply(this,arguments)},u=t.json,o=u.scenes[u.scene||0].nodes,i=o.length>1,s=[],c=(0,n.Z)(o);try{for(c.s();!(f=c.n()).done;)l=f.value,p=u.nodes[l],s.push(d(l,0)),Q(p)&&!i&&p.extensions.MSFT_lod.ids.forEach((function(e,t){return d(e,t+1)}))}catch(m){c.e(m)}finally{c.f()}return e.next=7,Promise.all(s);case 7:case"end":return e.stop()}}),e)}))),$.apply(this,arguments)}function Q(e){return e.extensions&&e.extensions.MSFT_lod&&Array.isArray(e.extensions.MSFT_lod.ids)}function ee(e,t,r){var n=function(t){var n="".concat(r,"_tex_").concat(t&&t.id).concat(t&&t.name?"_"+t.name:"");if(t&&!e.textures.has(n)){var a=m(t.data,{wrap:{s:t.wrapS,t:t.wrapT},mipmap:re.some((function(e){return e===t.minFilter})),noUnpackFlip:!0});e.textures.set(n,a)}return n},a="".concat(r,"_mat_").concat(t.id,"_").concat(t.name);if(!e.materials.has(a)){var u=h({color:[t.color[0],t.color[1],t.color[2]],opacity:t.color[3],alphaMode:t.alphaMode,alphaCutoff:t.alphaCutoff,doubleSided:t.doubleSided,colorMixMode:t.ESRI_externalColorMixMode,textureColor:t.colorTexture?n(t.colorTexture):void 0,textureNormal:t.normalTexture?n(t.normalTexture):void 0,textureOcclusion:t.occlusionTexture?n(t.occlusionTexture):void 0,textureEmissive:t.emissiveTexture?n(t.emissiveTexture):void 0,textureMetallicRoughness:t.metallicRoughnessTexture?n(t.metallicRoughnessTexture):void 0,emissiveFactor:[t.emissiveFactor[0],t.emissiveFactor[1],t.emissiveFactor[2]],metallicFactor:t.metallicFactor,roughnessFactor:t.roughnessFactor});e.materials.set(a,u)}return a}var te=new p,re=[9987,9985],ne=["POINTS","LINES","LINE_LOOP","LINE_STRIP","TRIANGLES","TRIANGLE_STRIP","TRIANGLE_FAN"]},52421:function(e,t,r){r.d(t,{NO:function(){return v},cM:function(){return m},p:function(){return d},DX:function(){return h}});r(41539),r(29135),r(48675),r(92990),r(18927),r(33105),r(35035),r(74345),r(7174),r(32846),r(44731),r(77209),r(96319),r(58867),r(37789),r(33739),r(29368),r(14483),r(12056),r(3462),r(30678),r(27462),r(33824),r(55021),r(12974),r(15016),r(8255),r(47042);var n=r(30348),a=r(42325),u=r(52111);r(41666),r(14937),r(79039);function o(e){return e?{origin:(0,a.a)(e.origin),vector:(0,a.a)(e.vector)}:{origin:(0,a.c)(),vector:(0,a.c)()}}(0,a.c)(),(0,a.c)(),new u.x((function(){return{origin:null,vector:null}}));function i(e,t,r){return(0,n.f)(s,t,e),(0,n.f)(c,r,e),(0,n.l)((0,n.c)(s,s,c))/2}new u.x(o),new u.x((function(){return{p0:null,p1:null,p2:null}}));var s=(0,a.c)(),c=(0,a.c)(),f=function(){for(var e=new Uint32Array(131072),t=0;t<e.length;++t)e[t]=t;return e}(),l=new Uint16Array([0]),p=function(){for(var e=new Uint16Array(65536),t=0;t<e.length;++t)e[t]=t;return e}();function d(e){if(1===e)return l;if(e<p.length)return new Uint16Array(p.buffer,0,e);if(e>f.length){var t=Math.max(2*f.length,e);f=new Uint32Array(t);for(var r=0;r<f.length;r++)f[r]=r}return new Uint32Array(f.buffer,0,e)}function h(e){if(1===e)return new Uint16Array(l);if(e<p.length)return new Uint16Array(p.slice(0,e));if(e>f.length){for(var t=new Uint32Array(e),r=0;r<t.length;r++)t[r]=r;return t}return new Uint32Array(f.slice(0,e))}function m(e,t,r){if(!e)return!1;var a=e.size,u=e.data;(0,n.s)(r,0,0,0),(0,n.s)(w,0,0,0);for(var o=0,s=0,c=0;c<t.length-2;c+=3){var f=t[c+0]*a,l=t[c+1]*a,p=t[c+2]*a;(0,n.s)(y,u[f+0],u[f+1],u[f+2]),(0,n.s)(x,u[l+0],u[l+1],u[l+2]),(0,n.s)(b,u[p+0],u[p+1],u[p+2]);var d=i(y,x,b);d?((0,n.b)(y,y,x),(0,n.b)(y,y,b),(0,n.a)(y,y,1/3*d),(0,n.b)(r,r,y),o+=d):((0,n.b)(w,w,y),(0,n.b)(w,w,x),(0,n.b)(w,w,b),s+=3)}return(0!==s||0!==o)&&(0!==o?((0,n.a)(r,r,1/o),!0):0!==s&&((0,n.a)(r,w,1/s),!0))}function v(e,t,r){if(!e||!t)return!1;var a=e.size,u=e.data;(0,n.s)(r,0,0,0);for(var o=-1,i=0,s=0;s<t.length;s++){var c=t[s]*a;o!==c&&(r[0]+=u[c+0],r[1]+=u[c+1],r[2]+=u[c+2],i++),o=c}return i>1&&(0,n.a)(r,r,1/i),i>0}var y=(0,a.c)(),x=(0,a.c)(),b=(0,a.c)(),w=(0,a.c)()},96773:function(e,t,r){r.d(t,{K:function(){return n}});var n=2.1}}]);