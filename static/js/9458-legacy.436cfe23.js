"use strict";(self["webpackChunkvue_url_arcgis"]=self["webpackChunkvue_url_arcgis"]||[]).push([[9458],{19458:function(e,r,t){t.r(r),t.d(r,{fromUrl:function(){return c}});var n=t(4367),a=t(16198),u=(t(78975),t(69826),t(41539),t(54747),t(78783),t(33948),t(68309),t(21249),t(57327),t(35680)),s=(t(25585),t(27092)),l=t(58476),i=t(46561),o=t(56676);function c(e){return p.apply(this,arguments)}function p(){return p=(0,a.Z)(regeneratorRuntime.mark((function e(r){var a,u,s,l,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return u=null==(a=r.properties)?void 0:a.customParameters,e.next=3,d(r.url,u);case 3:if(s=e.sent,l=(0,n.Z)((0,n.Z)({},r.properties),{},{url:r.url}),s.sublayerIds){e.next=7;break}return e.abrupt("return",(null!=s.layerOrTableId&&(l.layerId=s.layerOrTableId,l.sourceJSON=s.sourceJSON),new s.Constructor(l)));case 7:return e.next=10,t.e(9593).then(t.bind(t,79593));case 10:return e.t0=e.sent.default,e.t1={title:s.parsedUrl.title},i=new e.t0(e.t1),e.abrupt("return",(f(i,s,l),i));case 14:case"end":return e.stop()}}),e)}))),p.apply(this,arguments)}function y(e,r){return e?e.find((function(e){return e.id===r})):null}function f(e,r,t){function a(e,a){var u=(0,n.Z)((0,n.Z)({},t),{},{layerId:e,sublayerTitleMode:"service-name"});return(0,s.pC)(a)&&(u.sourceJSON=a),new r.Constructor(u)}r.sublayerIds.forEach((function(t){var n=a(t,y(r.sublayerInfos,t));e.add(n)})),r.tableIds.forEach((function(t){var n=a(t,y(r.tableInfos,t));e.tables.add(n)}))}function d(e,r){return h.apply(this,arguments)}function h(){return h=(0,a.Z)(regeneratorRuntime.mark((function e(r,t){var n,a,u,l,o,c,p,y,f,d,h,v,m;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=(0,i.Qc)(r),e.t0=(0,s.Wi)(n),!e.t0){e.next=6;break}return e.next=5,b(r,t);case 5:n=e.sent;case 6:if(!(0,s.Wi)(n)){e.next=8;break}throw new h("arcgis-layers:url-mismatch","The url '${url}' is not a valid arcgis resource",{url:r});case 8:a=n,u=a.serverType,l=a.sublayer,c={FeatureServer:"FeatureLayer",StreamServer:"StreamLayer",VectorTileServer:"VectorTileLayer"},e.t1=u,e.next="MapServer"===e.t1?13:"ImageServer"===e.t1?15:"SceneServer"===e.t1?17:19;break;case 13:return o=null!=l?"FeatureLayer":L(r,t).then((function(e){return e?"TileLayer":"MapImageLayer"})),e.abrupt("break",20);case 15:return o=R(r,t).then((function(e){var r=e.tileInfo&&e.tileInfo.format;return e.tileInfo?!r||"LERC"!==r.toUpperCase()||e.cacheType&&"elevation"!==e.cacheType.toLowerCase()?"ImageryTileLayer":"ElevationLayer":"ImageryLayer"})),e.abrupt("break",20);case 17:return o=R(n.url.path,t).then((function(e){if(e){if("Voxel"===(null==e?void 0:e.layerType))return"VoxelLayer";if(null!=e&&e.layers&&Array.isArray(e.layers)&&e.layers.length>0){var r,t={Point:"SceneLayer","3DObject":"SceneLayer",IntegratedMesh:"IntegratedMeshLayer",PointCloud:"PointCloudLayer",Building:"BuildingSceneLayer"},n=null==(r=e.layers[0])?void 0:r.layerType;if(null!=t[n])return t[n]}}return"SceneLayer"})),e.abrupt("break",20);case 19:o=c[u];case 20:return p={FeatureLayer:!0,SceneLayer:!0},y="FeatureServer"===u,f={parsedUrl:n,Constructor:null,layerOrTableId:y?l:null,sublayerIds:null,tableIds:null},e.next=25,o;case 25:if(d=e.sent,!p[d]||null!=l){e.next=32;break}return e.next=29,w(r,u,t);case 29:h=e.sent,y&&(f.sublayerInfos=h.layerInfos,f.tableInfos=h.tableInfos),1!==h.layerIds.length+h.tableIds.length?(f.sublayerIds=h.layerIds,f.tableIds=h.tableIds):y&&(f.layerOrTableId=null!=(v=h.layerIds[0])?v:h.tableIds[0],f.sourceJSON=null!=(m=h.layerInfos[0])?m:h.tableInfos[0]);case 32:return e.next=34,k(d);case 34:return f.Constructor=e.sent,e.abrupt("return",f);case 36:case"end":return e.stop()}}),e)}))),h.apply(this,arguments)}function b(e,r){return v.apply(this,arguments)}function v(){return v=(0,a.Z)(regeneratorRuntime.mark((function e(r,t){var n,a,u,o,c,p;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,R(r,t);case 2:if(a=e.sent,u=null,o=null,c=a.type,"Feature Layer"===c||"Table"===c?(u="FeatureServer",o=a.id):"indexedVector"===c?u="VectorTileServer":a.hasOwnProperty("mapName")?u="MapServer":a.hasOwnProperty("bandCount")&&a.hasOwnProperty("pixelSizeX")?u="ImageServer":a.hasOwnProperty("maxRecordCount")&&a.hasOwnProperty("allowGeometryUpdates")?u="FeatureServer":a.hasOwnProperty("streamUrls")?u="StreamServer":m(a)?(u="SceneServer",o=a.id):a.hasOwnProperty("layers")&&m(null==(n=a.layers)?void 0:n[0])&&(u="SceneServer"),u){e.next=7;break}return e.abrupt("return",null);case 7:return p=null!=o?(0,i.DR)(r):null,e.abrupt("return",{title:(0,s.pC)(p)&&a.name||(0,l.vt)(r),serverType:u,sublayer:o,url:{path:(0,s.pC)(p)?p.serviceUrl:(0,l.mN)(r).path}});case 9:case"end":return e.stop()}}),e)}))),v.apply(this,arguments)}function m(e){return(null==e?void 0:e.hasOwnProperty("store"))&&e.hasOwnProperty("id")&&"number"==typeof e.id}function w(e,r,t){return I.apply(this,arguments)}function I(){return I=(0,a.Z)(regeneratorRuntime.mark((function e(r,t,n){var a,u,s,l,i,o,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(l=!1,"FeatureServer"!==t){e.next=8;break}return e.next=4,x(r,n);case 4:i=e.sent,l=!!i.layersJSON,s=i.layersJSON||i.serviceJSON,e.next=11;break;case 8:return e.next=10,R(r,n);case 10:s=e.sent;case 11:return o=null==(a=s)?void 0:a.layers,c=null==(u=s)?void 0:u.tables,e.abrupt("return",{layerIds:(null==o?void 0:o.map((function(e){return e.id})).reverse())||[],tableIds:(null==c?void 0:c.map((function(e){return e.id})).reverse())||[],layerInfos:l?o:[],tableInfos:l?c:[]});case 13:case"end":return e.stop()}}),e)}))),I.apply(this,arguments)}function S(e){return!e.type||"Feature Layer"===e.type}function x(e,r){return g.apply(this,arguments)}function g(){return g=(0,a.Z)(regeneratorRuntime.mark((function e(r,t){var n,a,u,s,l;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,R(r,t);case 2:if(u=e.sent,u=u||{},u.layers=(null==(n=u.layers)?void 0:n.filter(S))||[],s={serviceJSON:u},!(u.currentVersion<10.5)){e.next=7;break}return e.abrupt("return",s);case 7:return e.next=9,R(r+"/layers",t);case 9:return l=e.sent,e.abrupt("return",(s.layersJSON={layers:(null==l||null==(a=l.layers)?void 0:a.filter(S))||[],tables:(null==l?void 0:l.tables)||[]},s));case 11:case"end":return e.stop()}}),e)}))),g.apply(this,arguments)}function k(e){return O.apply(this,arguments)}function O(){return O=(0,a.Z)(regeneratorRuntime.mark((function e(r){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,o.T[r])());case 1:case"end":return e.stop()}}),e)}))),O.apply(this,arguments)}function L(e,r){return T.apply(this,arguments)}function T(){return T=(0,a.Z)(regeneratorRuntime.mark((function e(r,t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,R(r,t);case 2:return e.abrupt("return",e.sent.tileInfo);case 3:case"end":return e.stop()}}),e)}))),T.apply(this,arguments)}function R(e,r){return C.apply(this,arguments)}function C(){return C=(0,a.Z)(regeneratorRuntime.mark((function e(r,t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,u["default"])(r,{responseType:"json",query:(0,n.Z)({f:"json"},t)});case 2:return e.abrupt("return",e.sent.data);case 3:case"end":return e.stop()}}),e)}))),C.apply(this,arguments)}}}]);